2017-09-01 09:12:01.672  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 09:12:01.678  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 09:12:01.704  IdentityServer4.Hosting.CookieConfiguration   Debug: Using built-in cookie authentication service for sign-in (idsrv) and external authentication (idsrv.external)
2017-09-01 12:51:37.235  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 12:51:37.255  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 12:51:37.276  IdentityServer4.Hosting.CookieConfiguration   Debug: Using built-in cookie authentication service for sign-in (idsrv) and external authentication (idsrv.external)
2017-09-01 12:51:37.675  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/  
2017-09-01 12:51:37.816  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.HomeController.Index (IdentitySite) with arguments ((null)) - ModelState is Valid
2017-09-01 12:51:45.073  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 12:51:45.081  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 12:51:45.105  IdentityServer4.Hosting.CookieConfiguration   Debug: Using built-in cookie authentication service for sign-in (idsrv) and external authentication (idsrv.external)
2017-09-01 12:51:45.480  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/  
2017-09-01 12:51:45.606  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.HomeController.Index (IdentitySite) with arguments ((null)) - ModelState is Valid
2017-09-01 12:51:47.804  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Home/Index.cshtml.
2017-09-01 12:51:48.496  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.HomeController.Index (IdentitySite) in 2893.3937ms
2017-09-01 12:51:48.505  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3038.1466ms 200 text/html; charset=utf-8
2017-09-01 12:51:56.381  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 12:51:56.386  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 12:51:56.395  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 12:51:56.397  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 12:51:56.405  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 12:51:56.574  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 12:51:56.654  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 273.3603ms 200 application/json
2017-09-01 12:52:27.970  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 12:52:27.974  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 12:52:27.976  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 12:52:27.979  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 12:52:27.982  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 12:52:27.989  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 12:52:27.994  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 23.8088ms 200 application/json
2017-09-01 12:52:28.067  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration/jwks  
2017-09-01 12:52:28.070  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-09-01 12:52:28.074  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 12:52:28.078  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration/jwks
2017-09-01 12:52:28.084  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start key discovery request
2017-09-01 12:52:28.105  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 38.4641ms 200 application/json
2017-09-01 12:52:28.140  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 12:52:28.145  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 12:52:28.156  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 12:52:28.159  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 12:52:28.170  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 12:52:28.184  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 12:52:28.193  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 12:52:28.257  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (23ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 12:52:28.275  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.278  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.282  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 12:52:28.284  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.286  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.321  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 12:52:28.331  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 12:52:28.341  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 12:52:28.346  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 12:52:28.356  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 12:52:28.374  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE",
  "Nonce": "636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 12:52:28.385  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 12:52:28.393  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 252.4264ms 302 
2017-09-01 12:52:28.398  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 12:52:28.456  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 12:52:28.474  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 12:52:28.479  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 12:52:28.483  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.486  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.488  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 12:52:28.491  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.493  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 12:52:28.497  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 12:52:28.501  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 12:52:28.504  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 12:52:28.507  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 12:52:28.509  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 12:52:28.516  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 12:52:28.869  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 12:52:28.907  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 480.3721ms
2017-09-01 12:52:28.911  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 512.5506ms 200 text/html; charset=utf-8
2017-09-01 12:52:29.114  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/favicon.ico  
2017-09-01 12:52:29.119  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 4.7166ms 404 
2017-09-01 12:52:32.518  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 12:52:32.555  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 12:52:32.574  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 12:52:32.598  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 63.4677ms
2017-09-01 12:52:32.645  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No IAuthenticationSignInHandler is configured to handle sign in for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<SignInAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentitySite.Controllers.AccountController.<Login>d__8.MoveNext() in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Controllers\AccountController.cs:line 85
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 12:52:32.705  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 187.1077ms 500 text/html; charset=utf-8
2017-09-01 12:56:32.291  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 12:56:32.299  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 12:56:32.320  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 12:56:32.393  Microsoft.AspNetCore.Hosting.Internal.WebHost   Critical: Application startup exception

System.InvalidOperationException: Scheme already exists: idsrv
   at Microsoft.AspNetCore.Authentication.AuthenticationOptions.AddScheme(String name, Action`1 configureBuilder)
   at Microsoft.AspNetCore.Authentication.AuthenticationBuilder.<>c__DisplayClass4_0`2.<AddScheme>b__0(AuthenticationOptions o)
   at Microsoft.Extensions.Options.ConfigureNamedOptions`1.Configure(String name, TOptions options)
   at Microsoft.Extensions.Options.OptionsFactory`1.Create(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.<>c__DisplayClass5_0.<Get>b__0()
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)
   at System.Lazy`1.CreateValue()
   at Microsoft.Extensions.Options.OptionsCache`1.GetOrAdd(String name, Func`1 createOptions)
   at Microsoft.Extensions.Options.OptionsManager`1.Get(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.get_Value()
   at IdentityServer4.Hosting.CookieConfiguration.ConfigureCookies(IApplicationBuilder app)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.UseIdentityServer(IApplicationBuilder app)
   at IdentitySite.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory, IFileManager fileManager, IHttpContextAccessor httpContextAccessor) in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Startup.cs:line 97
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.ApplicationInsights.HostingStartup.ApplicationInsightsLoggerStartupFilter.<>c__DisplayClass0_1.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.ApplicationInsights.AspNetCore.ApplicationInsightsStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass3_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2017-09-01 12:56:32.695  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398383481228901.N2QwMGI2ZDQtM2Y4My00MDMzLWE3MDYtMmYwMzFiNTFkYjM2Njc5YTgzYmMtMDZjMy00MGI3LTkwMTUtODRlMTYzZjQwMzY3%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aWR2wL5Mr8ToBMzsZ16PNnlmRP9Id0lMKcTwI0NGKXfmR4jImW1c0ddvSjBrztK2zWMDKNEYy507NGTHUprkZ_-odrK5ezfxG69zHgsPQGpzkRoEoBS256DokeN4g0GFkFv3MutHU4k0Uq3s--1AQazFwvlBjBgXWfBegL3MPI-A7Nd0fZemV8qd4w7KrgaiElqc7yWvwdVfEhjVfC3QextOiQ_Ox347z3L2DoaMUrF7VxYPfhVNlcpLlaTmiN4QV0vaEQH_2yGiS-q9tmxT2e82alYuAxTjnzg7CZp2qxmuSY7CBpJ8FhNRaGOFsc_PE%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 12:56:32.728  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 44.4502ms 500 text/html; charset=utf-8
2017-09-01 12:56:38.849  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398385988368655.YzFiOGMxNmMtYzhkZC00OWIxLTkxY2ItMzNlNWMxMmMwNDllNjViYTQzMDUtOWNjMi00ZmIxLTg2NmYtZmEzODk3Njk1OGIx&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bRl3sv-4114zR4ZxZGF7w6F-Nsi1RObSp2Oum-tKlaht4jni76S6QKF88rQzOy-QyIv3ZbTL-P7cYiKIaar1eUReHs-TWDX1cePB5c0Fn2xVZu1a-jHqTd3iIvmW3b2zRhYl8LCrtZn765zuFJZVDpTETkRIB28WT6jmgvQGn0FvVCZ0nBNfW_CjSduldVOnub9h7dIWOxzaEt2ex3xPj3JD8ui9-Q6XiMpcqcfOm3dAzoSdEgbP_9S6TCLOVNRn1m2OsBZp8K9zRcQUmAspLXKPoUnwPKdf7sXnk9dYWkOshaIKj3iMHVVUv9RoDrBdA&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 12:56:38.869  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 20.0441ms 500 text/html; charset=utf-8
2017-09-01 12:57:07.733  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 12:57:07.740  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 12:57:07.768  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 12:57:08.122  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 12:57:08.190  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No authentication handler is configured to authenticate for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<AuthenticateAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<GetCurrentSessionIdAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<EnsureSessionIdCookieAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 12:57:08.244  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 134.2355ms 500 text/html; charset=utf-8
2017-09-01 12:57:08.297  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 12:57:08.306  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 12:57:08.314  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 16.5639ms 200 image/x-icon
2017-09-01 13:00:26.267  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:00:26.273  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:00:26.292  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 13:00:26.690  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:00:26.760  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No authentication handler is configured to authenticate for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<AuthenticateAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<GetCurrentSessionIdAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<EnsureSessionIdCookieAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:00:26.820  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 142.2146ms 500 text/html; charset=utf-8
2017-09-01 13:00:26.862  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:00:26.873  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 13:00:26.878  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 16.5697ms 200 image/x-icon
2017-09-01 13:04:35.646  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:04:35.652  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:04:35.674  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 13:04:36.090  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:04:36.169  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No authentication handler is configured to authenticate for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<AuthenticateAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<GetCurrentSessionIdAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<EnsureSessionIdCookieAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:04:36.236  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 157.1836ms 500 text/html; charset=utf-8
2017-09-01 13:04:36.253  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:04:36.263  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 13:04:36.268  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 15.1248ms 200 image/x-icon
2017-09-01 13:05:18.916  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:05:18.923  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:05:18.949  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 13:05:19.013  Microsoft.AspNetCore.Hosting.Internal.WebHost   Critical: Application startup exception

System.InvalidOperationException: Scheme already exists: idsrv
   at Microsoft.AspNetCore.Authentication.AuthenticationOptions.AddScheme(String name, Action`1 configureBuilder)
   at Microsoft.AspNetCore.Authentication.AuthenticationBuilder.<>c__DisplayClass4_0`2.<AddScheme>b__0(AuthenticationOptions o)
   at Microsoft.Extensions.Options.ConfigureNamedOptions`1.Configure(String name, TOptions options)
   at Microsoft.Extensions.Options.OptionsFactory`1.Create(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.<>c__DisplayClass5_0.<Get>b__0()
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)
   at System.Lazy`1.CreateValue()
   at Microsoft.Extensions.Options.OptionsCache`1.GetOrAdd(String name, Func`1 createOptions)
   at Microsoft.Extensions.Options.OptionsManager`1.Get(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.get_Value()
   at IdentityServer4.Hosting.CookieConfiguration.ConfigureCookies(IApplicationBuilder app)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.UseIdentityServer(IApplicationBuilder app)
   at IdentitySite.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory, IFileManager fileManager, IHttpContextAccessor httpContextAccessor) in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Startup.cs:line 100
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.ApplicationInsights.HostingStartup.ApplicationInsightsLoggerStartupFilter.<>c__DisplayClass0_1.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.ApplicationInsights.AspNetCore.ApplicationInsightsStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass3_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2017-09-01 13:05:19.314  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:05:19.343  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 40.2676ms 500 text/html; charset=utf-8
2017-09-01 13:05:19.388  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:05:19.414  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 25.5626ms 500 text/html; charset=utf-8
2017-09-01 13:07:36.603  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:07:36.609  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:07:36.631  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: Cookies
2017-09-01 13:07:37.010  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:07:37.080  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No authentication handler is configured to authenticate for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<AuthenticateAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<GetCurrentSessionIdAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultUserSession.<EnsureSessionIdCookieAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:07:37.155  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 156.3269ms 500 text/html; charset=utf-8
2017-09-01 13:07:37.180  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:07:37.187  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 13:07:37.195  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 15.3118ms 200 image/x-icon
2017-09-01 13:08:41.637  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:08:41.643  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:08:41.665  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:08:42.088  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:08:42.129  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 13:08:42.136  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 13:08:42.139  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 13:08:42.146  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 13:08:42.320  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (13ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 13:08:42.406  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 329.663ms 200 application/json
2017-09-01 13:08:42.439  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:08:42.454  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 13:08:42.460  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 21.1965ms 200 image/x-icon
2017-09-01 13:09:01.555  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:09:01.558  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:09:01.570  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:09:01.573  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:09:01.585  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:09:01.600  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:09:01.608  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:09:01.673  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (25ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:01.691  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.693  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.696  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:09:01.699  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.701  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.735  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:01.745  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:01.757  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:01.760  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:01.770  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:09:01.788  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE",
  "Nonce": "636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:09:01.798  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:09:01.806  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 251.3218ms 302 
2017-09-01 13:09:01.811  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:09:01.944  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:09:01.962  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:09:01.969  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:01.974  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.977  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.980  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:09:01.983  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.985  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:01.989  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:01.992  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:01.995  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:01.999  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:02.002  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:09:02.008  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:04.527  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:09:04.931  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3022.3739ms
2017-09-01 13:09:04.944  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3132.3237ms 200 text/html; charset=utf-8
2017-09-01 13:09:11.058  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 13:09:11.100  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:09:11.121  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:09:11.147  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 70.5814ms
2017-09-01 13:09:11.200  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: No IAuthenticationSignInHandler is configured to handle sign in for the scheme: Cookies
   at Microsoft.AspNetCore.Authentication.AuthenticationService.<SignInAsync>d__13.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentitySite.Controllers.AccountController.<Login>d__8.MoveNext() in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Controllers\AccountController.cs:line 85
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:09:11.275  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 217.2272ms 500 text/html; charset=utf-8
2017-09-01 13:09:40.267  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:09:40.273  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:09:40.294  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:09:40.659  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:09:40.839  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393415407226.YTlkN2Q0MDUtMzllMS00NTE3LWI4NjgtNWM2ZGRhMjdmNjJmOWY4NGFhN2ItM2Y3Zi00Zjc2LWFlNzYtODc4MzEzYTgxNDll&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bNfODvxmaTb8IUYzam0xRt3C9FNEcCU0sIDzWaDSiZfFSi2-IK1_giUs62uG_puHwbEE__XYwBGnUvWeGtvhLcKsw43xfWpO7DLi6DlZKzLTiTrCro6wJY8YatAXaFdSaIPwq1VRhZlfVoKzvlMLCaJb1u1m71vLzkhwR-aTDq46Dv1OhxLZ8YcXlPklMsWMP6e9-3noAsr-UpWRzrM23XX8js_GuCjah1t1G-HzPbDge68y7tlxkpCrVNxldUeWkBQ87gDE8OGB-yY8xb3kw0eoBA5LN2y88Kt7rdpflKOvF2tWg7YBbLOA9thEESuvE&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:09:40.867  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:09:41.107  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (43ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:41.150  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:41.153  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:41.156  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:09:41.158  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:41.160  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:41.198  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:41.217  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:41.244  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:41.250  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:41.262  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:09:41.272  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:43.816  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:09:44.208  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3409.3422ms
2017-09-01 13:09:44.227  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3580.6285ms 200 text/html; charset=utf-8
2017-09-01 13:09:47.065  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi&state=CfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:09:47.070  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:09:47.080  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:09:47.083  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:09:47.096  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:09:47.106  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:09:47.109  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:09:47.116  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:47.119  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.122  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.126  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:09:47.128  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.131  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.135  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:47.139  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:47.143  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:47.147  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:47.150  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:09:47.173  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ",
  "Nonce": "636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:09:47.184  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:09:47.193  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 128.4955ms 302 
2017-09-01 13:09:47.198  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:09:47.203  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi&state=CfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:09:47.208  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:09:47.212  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:47.215  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.218  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.221  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:09:47.223  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.226  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:09:47.229  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:47.232  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:47.235  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:09:47.239  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:09:47.242  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:09:47.245  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:09:47.251  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:09:47.260  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 58.6084ms
2017-09-01 13:09:47.264  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 65.4171ms 200 text/html; charset=utf-8
2017-09-01 13:09:50.848  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 13:09:50.885  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:09:50.903  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:09:50.922  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:09:50.926  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 59.5045ms
2017-09-01 13:09:50.979  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: sub claim is missing
   at IdentityServer4.IdentityServerPrincipal.AssertRequiredClaims(ClaimsPrincipal principal)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.AugmentPrincipal(ClaimsPrincipal principal)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHttpContextExtensions.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at IdentitySite.Controllers.AccountController.<Login>d__8.MoveNext() in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Controllers\AccountController.cs:line 85
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:09:51.062  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 211.6517ms 500 text/html; charset=utf-8
2017-09-01 13:18:37.476  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:18:37.484  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:18:37.504  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:18:37.853  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:18:38.094  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398393870532227.ODUwMGYzMGMtMDMyYS00NDg3LTg5YzktMmY5MzBhZDIwNDlmNTk1ODdiMjUtYWRiOC00MjMwLWFmMzUtNGE5ZDg3YTZjN2Zi&state=CfDJ8ECGCikUVX1HsEI_-gAmK4YrdGc5mwMcHfJxhfLsyAlniMF1FDeOgef9EoYVbt3cNyVbxkisgIRUGsmXFjJ0RDp1Vh9W7q2UNuM3qnydt7q3nDXlVyF_wrSo7nMyPRDvoor8AcTHxVMF7aBpL4m_uODROK_OOv18I98O1W0RPyV2f2BBV_fm6FzR4Gm92gA3Oih7LGNO6HrDJnZnXiD9TF920Bo5z30_pdpb84g889Kqem_nJR68erurJNlWZkfV621FqRjTULs8obRRsrWpaJcxCG81XCvMOfPTIgl5ze0r_4Ffh71zUkjmC_leW0dUy9iZrD0Fykd6X39TSyvV5YQ&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:18:38.125  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:18:38.332  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (39ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:18:38.381  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.385  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.387  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:18:38.389  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.392  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.430  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:38.449  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:38.475  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:38.478  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:38.492  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:18:38.500  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:18:38.888  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399188715281.NmMxMDJiODctNDEyNi00MjJlLTgxZTMtOWZkMGNlMTQ0MmEyN2U4OTg4ZjgtMDY1NC00OTllLWE3MDQtY2Y2YjlkNWQ5YjE0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZCl5EdooEueS6VRjwBkspciWZkAwV7Zcn-CgVssePBaflbG5bjAMwPXWmNpjZi_bRmmvGz811VM3DgQIO-Q-5kpyqPh3uEA5szfl6aSi_YZicS-jKUUpPogpj34JgowKPtyDNGByJ4mNE4uSzuD2YfgdPSKtdwItl8yOxbnyOB9zAC31BkvbwndldaS7IDZ8nKMwh7w3IL0zmTsGw3QEd-S_N3zFPa2N6xlV5ZUBpO-A2PWyg_kxHgw4crpT4maSRfU1AnaVuV59nqwfnHhRiGp0_gehz5qCFJKB2KMHV4y0smroq9no61RFHuN3kCDfY&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:18:38.892  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:18:38.906  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:18:38.909  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:18:38.922  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:18:38.932  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:18:38.935  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:18:38.940  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:18:38.944  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.948  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.951  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:18:38.954  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.957  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:38.960  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:38.963  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:38.969  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:38.974  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:38.976  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:18:39.021  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZCl5EdooEueS6VRjwBkspciWZkAwV7Zcn-CgVssePBaflbG5bjAMwPXWmNpjZi_bRmmvGz811VM3DgQIO-Q-5kpyqPh3uEA5szfl6aSi_YZicS-jKUUpPogpj34JgowKPtyDNGByJ4mNE4uSzuD2YfgdPSKtdwItl8yOxbnyOB9zAC31BkvbwndldaS7IDZ8nKMwh7w3IL0zmTsGw3QEd-S_N3zFPa2N6xlV5ZUBpO-A2PWyg_kxHgw4crpT4maSRfU1AnaVuV59nqwfnHhRiGp0_gehz5qCFJKB2KMHV4y0smroq9no61RFHuN3kCDfY",
  "Nonce": "636398399188715281.NmMxMDJiODctNDEyNi00MjJlLTgxZTMtOWZkMGNlMTQ0MmEyN2U4OTg4ZjgtMDY1NC00OTllLWE3MDQtY2Y2YjlkNWQ5YjE0",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399188715281.NmMxMDJiODctNDEyNi00MjJlLTgxZTMtOWZkMGNlMTQ0MmEyN2U4OTg4ZjgtMDY1NC00OTllLWE3MDQtY2Y2YjlkNWQ5YjE0",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZCl5EdooEueS6VRjwBkspciWZkAwV7Zcn-CgVssePBaflbG5bjAMwPXWmNpjZi_bRmmvGz811VM3DgQIO-Q-5kpyqPh3uEA5szfl6aSi_YZicS-jKUUpPogpj34JgowKPtyDNGByJ4mNE4uSzuD2YfgdPSKtdwItl8yOxbnyOB9zAC31BkvbwndldaS7IDZ8nKMwh7w3IL0zmTsGw3QEd-S_N3zFPa2N6xlV5ZUBpO-A2PWyg_kxHgw4crpT4maSRfU1AnaVuV59nqwfnHhRiGp0_gehz5qCFJKB2KMHV4y0smroq9no61RFHuN3kCDfY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:18:39.036  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:18:39.052  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 163.1975ms 302 
2017-09-01 13:18:39.061  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399188715281.NmMxMDJiODctNDEyNi00MjJlLTgxZTMtOWZkMGNlMTQ0MmEyN2U4OTg4ZjgtMDY1NC00OTllLWE3MDQtY2Y2YjlkNWQ5YjE0%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZCl5EdooEueS6VRjwBkspciWZkAwV7Zcn-CgVssePBaflbG5bjAMwPXWmNpjZi_bRmmvGz811VM3DgQIO-Q-5kpyqPh3uEA5szfl6aSi_YZicS-jKUUpPogpj34JgowKPtyDNGByJ4mNE4uSzuD2YfgdPSKtdwItl8yOxbnyOB9zAC31BkvbwndldaS7IDZ8nKMwh7w3IL0zmTsGw3QEd-S_N3zFPa2N6xlV5ZUBpO-A2PWyg_kxHgw4crpT4maSRfU1AnaVuV59nqwfnHhRiGp0_gehz5qCFJKB2KMHV4y0smroq9no61RFHuN3kCDfY%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:18:39.070  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399188715281.NmMxMDJiODctNDEyNi00MjJlLTgxZTMtOWZkMGNlMTQ0MmEyN2U4OTg4ZjgtMDY1NC00OTllLWE3MDQtY2Y2YjlkNWQ5YjE0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZCl5EdooEueS6VRjwBkspciWZkAwV7Zcn-CgVssePBaflbG5bjAMwPXWmNpjZi_bRmmvGz811VM3DgQIO-Q-5kpyqPh3uEA5szfl6aSi_YZicS-jKUUpPogpj34JgowKPtyDNGByJ4mNE4uSzuD2YfgdPSKtdwItl8yOxbnyOB9zAC31BkvbwndldaS7IDZ8nKMwh7w3IL0zmTsGw3QEd-S_N3zFPa2N6xlV5ZUBpO-A2PWyg_kxHgw4crpT4maSRfU1AnaVuV59nqwfnHhRiGp0_gehz5qCFJKB2KMHV4y0smroq9no61RFHuN3kCDfY&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:18:39.082  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:18:39.086  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:18:39.089  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:39.092  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:39.095  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:18:39.101  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:39.104  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:18:39.108  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:39.112  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:39.119  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:18:39.127  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:18:39.133  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:18:39.137  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:18:41.331  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:18:41.331  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:18:41.723  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 2647.6179ms
2017-09-01 13:18:41.723  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3669.3141ms
2017-09-01 13:18:41.751  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3918.7713ms 200 text/html; charset=utf-8
2017-09-01 13:18:41.752  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2691.2406ms 200 text/html; charset=utf-8
2017-09-01 13:18:44.768  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 13:18:44.806  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:18:44.827  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:18:44.847  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:18:44.851  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 67.0801ms
2017-09-01 13:18:44.903  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: sub claim is missing
   at IdentityServer4.IdentityServerPrincipal.AssertRequiredClaims(ClaimsPrincipal principal)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.AugmentPrincipal(ClaimsPrincipal principal)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHttpContextExtensions.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at IdentitySite.Controllers.AccountController.<Login>d__8.MoveNext() in D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\Controllers\AccountController.cs:line 86
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:18:44.978  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 209.3454ms 500 text/html; charset=utf-8
2017-09-01 13:19:06.954  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:19:06.960  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:19:06.981  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:19:09.847  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399497931802.MDQ1ZDA0ZDItZjNkZi00ZjQwLWJmOGQtN2MxZjc1NWEzYTZkMWIyZTk1MzktMmE0MS00NDc0LTgwM2MtNjkyNmMxOTI3YjJl&state=CfDJ8ECGCikUVX1HsEI_-gAmK4a3gwBIF7w-T4u0u1qRgljPI4J2e_L2jIUReT6-kpE6AXcr--Ze0YXBNx0GjVpCU-yPZEewwEVedTY3m4-UUtcth2LT6Ljffo4V7DXlog0AQR1fgkI1TBek9W6uR0sc833sLTjMuZiiBQwoM9MZrpXctfYgdKPscd_XejDZyWFlxFJjDw3WE30e2SgpFEkHHVzpII9DVY9GmYvwCGjbr-2wRrR6Z1gSmjsJRFVZ6aekExHEFLK-oiLsiydB1bScrKuUFx-5E3A_dQ-fMWNuJsKFuGVbd5gydPFJK1qgFMFn-zPo5M5MSwk60M6N6PBsIXo&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:19:09.890  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:19:09.901  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:19:09.904  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:19:09.915  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:19:09.931  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:19:09.939  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:19:10.140  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (35ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:10.186  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.188  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.191  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:19:10.193  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.197  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.237  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:10.255  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:10.280  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:10.284  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:10.296  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:19:10.319  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4a3gwBIF7w-T4u0u1qRgljPI4J2e_L2jIUReT6-kpE6AXcr--Ze0YXBNx0GjVpCU-yPZEewwEVedTY3m4-UUtcth2LT6Ljffo4V7DXlog0AQR1fgkI1TBek9W6uR0sc833sLTjMuZiiBQwoM9MZrpXctfYgdKPscd_XejDZyWFlxFJjDw3WE30e2SgpFEkHHVzpII9DVY9GmYvwCGjbr-2wRrR6Z1gSmjsJRFVZ6aekExHEFLK-oiLsiydB1bScrKuUFx-5E3A_dQ-fMWNuJsKFuGVbd5gydPFJK1qgFMFn-zPo5M5MSwk60M6N6PBsIXo",
  "Nonce": "636398399497931802.MDQ1ZDA0ZDItZjNkZi00ZjQwLWJmOGQtN2MxZjc1NWEzYTZkMWIyZTk1MzktMmE0MS00NDc0LTgwM2MtNjkyNmMxOTI3YjJl",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399497931802.MDQ1ZDA0ZDItZjNkZi00ZjQwLWJmOGQtN2MxZjc1NWEzYTZkMWIyZTk1MzktMmE0MS00NDc0LTgwM2MtNjkyNmMxOTI3YjJl",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4a3gwBIF7w-T4u0u1qRgljPI4J2e_L2jIUReT6-kpE6AXcr--Ze0YXBNx0GjVpCU-yPZEewwEVedTY3m4-UUtcth2LT6Ljffo4V7DXlog0AQR1fgkI1TBek9W6uR0sc833sLTjMuZiiBQwoM9MZrpXctfYgdKPscd_XejDZyWFlxFJjDw3WE30e2SgpFEkHHVzpII9DVY9GmYvwCGjbr-2wRrR6Z1gSmjsJRFVZ6aekExHEFLK-oiLsiydB1bScrKuUFx-5E3A_dQ-fMWNuJsKFuGVbd5gydPFJK1qgFMFn-zPo5M5MSwk60M6N6PBsIXo",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:19:10.332  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:19:10.343  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 509.7196ms 302 
2017-09-01 13:19:10.351  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399497931802.MDQ1ZDA0ZDItZjNkZi00ZjQwLWJmOGQtN2MxZjc1NWEzYTZkMWIyZTk1MzktMmE0MS00NDc0LTgwM2MtNjkyNmMxOTI3YjJl%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4a3gwBIF7w-T4u0u1qRgljPI4J2e_L2jIUReT6-kpE6AXcr--Ze0YXBNx0GjVpCU-yPZEewwEVedTY3m4-UUtcth2LT6Ljffo4V7DXlog0AQR1fgkI1TBek9W6uR0sc833sLTjMuZiiBQwoM9MZrpXctfYgdKPscd_XejDZyWFlxFJjDw3WE30e2SgpFEkHHVzpII9DVY9GmYvwCGjbr-2wRrR6Z1gSmjsJRFVZ6aekExHEFLK-oiLsiydB1bScrKuUFx-5E3A_dQ-fMWNuJsKFuGVbd5gydPFJK1qgFMFn-zPo5M5MSwk60M6N6PBsIXo%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:19:10.492  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399497931802.MDQ1ZDA0ZDItZjNkZi00ZjQwLWJmOGQtN2MxZjc1NWEzYTZkMWIyZTk1MzktMmE0MS00NDc0LTgwM2MtNjkyNmMxOTI3YjJl&state=CfDJ8ECGCikUVX1HsEI_-gAmK4a3gwBIF7w-T4u0u1qRgljPI4J2e_L2jIUReT6-kpE6AXcr--Ze0YXBNx0GjVpCU-yPZEewwEVedTY3m4-UUtcth2LT6Ljffo4V7DXlog0AQR1fgkI1TBek9W6uR0sc833sLTjMuZiiBQwoM9MZrpXctfYgdKPscd_XejDZyWFlxFJjDw3WE30e2SgpFEkHHVzpII9DVY9GmYvwCGjbr-2wRrR6Z1gSmjsJRFVZ6aekExHEFLK-oiLsiydB1bScrKuUFx-5E3A_dQ-fMWNuJsKFuGVbd5gydPFJK1qgFMFn-zPo5M5MSwk60M6N6PBsIXo&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:19:10.511  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:19:10.517  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:10.521  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.524  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.527  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:19:10.530  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.533  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:10.536  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:10.539  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:10.542  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:10.546  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:10.549  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:19:10.554  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:11.507  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:19:11.511  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:19:11.514  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:19:11.519  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:19:11.522  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:19:11.525  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:19:11.528  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:19:11.534  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:11.537  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.539  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.542  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:19:11.546  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.550  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.554  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:11.557  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:11.564  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:11.574  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:11.582  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:19:11.586  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
  "Nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:19:11.588  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:19:11.592  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 84.7704ms 302 
2017-09-01 13:19:11.600  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:19:11.606  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:19:11.616  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:19:11.621  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:11.626  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.628  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.631  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:19:11.634  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.636  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:11.640  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:11.644  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:11.648  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:11.651  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:11.655  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:19:11.659  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:13.339  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:19:13.339  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:19:13.730  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 2120.9087ms
2017-09-01 13:19:13.730  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3275.6923ms
2017-09-01 13:19:13.754  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3403.0685ms 200 text/html; charset=utf-8
2017-09-01 13:19:13.754  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2154.3349ms 200 text/html; charset=utf-8
2017-09-01 13:19:16.812  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 13:19:16.854  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:19:16.878  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:19:16.908  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:19:16.919  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 13:19:16.926  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 13:19:16.930  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 13:19:16.933  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 102.7141ms
2017-09-01 13:19:16.938  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 125.7138ms 302 
2017-09-01 13:19:16.943  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:19:16.949  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:16.953  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:16.956  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 13:19:16.959  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:19:16.962  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 13:19:16.973  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 13:19:16.975  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:16.983  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 13:19:16.985  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:19:16.989  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:19:16.992  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:16.994  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:16.997  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:19:16.999  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:17.003  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:19:17.006  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:17.009  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:17.012  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:19:17.016  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:19:17.019  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:17.022  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:19:17.025  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
  "Nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
  "SessionId": "f086b4cf11756f1eef20551b20c52417",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:19:17.040  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 13:19:17.043  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 13:19:17.048  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 104.7168ms 302 
2017-09-01 13:19:17.054  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:19:17.057  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:17.059  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:19:17.063  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 8.8244ms 404 
2017-09-01 13:21:33.195  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:21:33.202  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:21:33.222  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:21:33.603  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:21:33.634  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:33.648  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:33.788  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:21:33.808  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:33.819  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:21:34.006  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (32ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:21:34.051  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:34.054  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:34.057  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:21:34.060  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:34.063  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:34.100  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:34.118  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:34.143  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:34.147  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:34.159  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:34.162  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:21:34.169  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:21:36.699  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:21:37.072  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3320.6066ms
2017-09-01 13:21:37.097  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3506.4597ms 200 text/html; charset=utf-8
2017-09-01 13:21:41.142  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 999
2017-09-01 13:21:41.151  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.154  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.186  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:21:41.205  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:21:41.232  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:21:41.241  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 13:21:41.246  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 13:21:41.251  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 13:21:41.253  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 88.9145ms
2017-09-01 13:21:41.257  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 115.3396ms 302 
2017-09-01 13:21:41.263  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:21:41.266  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.270  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.272  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 13:21:41.282  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:21:41.285  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 13:21:41.298  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 13:21:41.303  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.314  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 13:21:41.318  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:21:41.322  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:21:41.325  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.329  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.332  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:21:41.334  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.337  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.340  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:41.344  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:41.348  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:41.352  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:41.355  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.357  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:21:41.380  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
  "Nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
  "SessionId": "80bbf4ec982f274c69dc996f8a702518",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:21:41.405  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 13:21:41.408  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 13:21:41.415  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 152.5398ms 302 
2017-09-01 13:21:41.421  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:21:41.424  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.427  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.435  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:21:41.444  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.447  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:21:41.451  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:21:41.455  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.458  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.460  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:21:41.462  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.464  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:21:41.468  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:41.471  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:41.474  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:41.477  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:41.479  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:21:41.482  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:21:41.485  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:21:41.488  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:21:41.491  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:21:41.927  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 13:21:42.236  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 802.5474ms
2017-09-01 13:21:42.239  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 818.1726ms 200 text/html; charset=utf-8
2017-09-01 13:21:42.315  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2  
2017-09-01 13:21:42.320  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap\dist\fonts\glyphicons-halflings-regular.woff2'
2017-09-01 13:21:42.325  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 9.5326ms 200 font/woff2
2017-09-01 13:22:02.429  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1021
2017-09-01 13:22:02.434  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:02.437  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:02.452  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 13:22:02.459  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:02.463  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:22:02.470  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:22:02.472  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:02.475  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:02.479  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:22:02.481  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:02.484  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:02.489  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:02.494  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:02.499  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:02.502  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:02.505  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:02.507  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:22:02.512  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:22:02.516  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:02.520  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:02.524  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 13:22:02.534  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 87.1034ms
2017-09-01 13:22:02.537  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 107.8445ms 200 text/html; charset=utf-8
2017-09-01 13:22:10.844  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 13:22:10.852  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.854  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.861  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 13:22:10.865  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.870  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:22:10.875  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:22:10.877  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:10.880  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:10.884  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:22:10.887  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:10.889  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:10.892  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:10.896  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:10.902  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:10.906  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:10.909  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.911  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:22:10.919  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.936  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 13:22:10.939  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 81.559ms
2017-09-01 13:22:10.941  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 97.7387ms 302 
2017-09-01 13:22:10.946  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:22:10.951  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.954  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.957  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 13:22:10.960  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:22:10.963  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 13:22:10.971  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 13:22:10.974  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:10.980  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 13:22:10.987  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:22:10.990  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:22:10.994  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:10.997  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:11.003  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:22:11.006  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:11.008  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:22:11.011  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:11.017  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:11.022  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:22:11.025  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:22:11.028  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:11.032  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:22:11.036  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
  "Nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
  "SessionId": "80bbf4ec982f274c69dc996f8a702518",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:22:11.039  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 13:22:11.047  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 13:22:11.053  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 13:22:11.077  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 13:22:11.089  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 13:22:11.097  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 13:22:11.102  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 13:22:11.152  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b7DbRHTYSgeRDmnrU5XrAqEJG6v5LqqTDUloK86B-x7gbOCK1TbVeS7-zs5htxTb9I8M36LaanozLMVV-PW8rF4I6gQCv8glCR0-OHgJJ6I8enYB9nOeTVKy-K5mZtCF_pIY9W-EGYf-0Js4Dwd1y8nWNJDmJDhNhSm1kpYKawMVXi6Cbnk15keKTyjQuUAxFJSupmW7Sj421V73iTnNyQM-sZHTxriOP6RInU-w9lJSELm065Fa_Lm9aj_6P40Be3byRPL-f_CINJny9HdHMYzf9Q7aUcwTPurCWB5bT3_KaEouHNemQxu9YSR8fpN7g",
  "Scope": "openid"
}
2017-09-01 13:22:11.169  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:11.178  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:22:11.181  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:22:11.184  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 13:22:11.194  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 248.2582ms 200 text/html; charset=UTF-8
2017-09-01 13:50:28.744  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 13:50:28.750  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 13:50:28.773  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 13:50:29.098  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/  
2017-09-01 13:50:29.132  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:50:29.147  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:50:29.238  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.HomeController.Index (IdentitySite) with arguments ((null)) - ModelState is Valid
2017-09-01 13:50:31.393  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Home/Index.cshtml.
2017-09-01 13:50:32.050  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.HomeController.Index (IdentitySite) in 2814.9685ms
2017-09-01 13:50:32.063  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2978.0042ms 200 text/html; charset=utf-8
2017-09-01 13:50:44.279  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:50:44.283  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:50:44.288  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:50:44.293  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 13:50:44.301  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 13:50:44.305  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 13:50:44.311  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 13:50:44.482  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 13:50:44.565  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 285.4546ms 200 application/json
2017-09-01 13:50:44.609  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 13:50:44.617  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 13:50:44.629  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 20.267ms 200 image/x-icon
2017-09-01 13:54:36.458  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 13:54:36.473  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 13:54:36.478  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 13:54:36.482  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 13:54:36.485  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 13:54:36.493  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 13:54:36.498  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 40.0668ms 200 application/json
2017-09-01 13:54:36.571  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration/jwks  
2017-09-01 13:54:36.574  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-09-01 13:54:36.577  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 13:54:36.580  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration/jwks
2017-09-01 13:54:36.585  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start key discovery request
2017-09-01 13:54:36.604  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 33.1368ms 200 application/json
2017-09-01 13:54:36.646  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDMzMzEsImV4cCI6MTUwNDI0MzYzMSwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4Mzk5NTE0OTE2NDMxLk5HUm1ZalptTXpJdE1UWXpOQzAwTVdSbUxXRXpaVEl0WXpRek16VTJNR1poWlRFelpEZGlOV1poTldFdE5ESmhZeTAwWlRBeUxXSXlPRE10TWpSak56QmtOR0prTVRjMSIsImlhdCI6MTUwNDI0MzMzMSwic2lkIjoiODBiYmY0ZWM5ODJmMjc0YzY5ZGM5OTZmOGE3MDI1MTgiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDMzMDEsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.gAC6TKJJkMx0gFq8KfCFmmkBj0fMX-i6sXzSCkPF0zktXA-z87nXa48Di2odjodbFYh2cZGwcta1OqykfAzVyUHgfN6hM19stlJNRY9PGta6CrVqDJqZlmhZejkGxs_-pJRMEw05oW_WXp1WG_3nIPkhhqXh-a0iw91oSr0ZJ3jDXD2SxtOo4zA-BgtxmhDK6LwMwh7mN7Omw9kEANcrQIGNvK8_GAcFKn6rK8CR4fpkRkhz9VLnn3gpglGPhNu2qZbVgyXiSmtKEItaDQD28dT4ToZb6vUpvnFXrng7XZpvKjV0Nx38Zb_ovNXro_jhE5Yze1ReORIByzFGdJiJ2Q&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aNyUzdpqlXWakI_7GZlAOZcBAzqAgUrB1zpWzbvIBR30wIR53axo_9msv7kx_CRQyCOY-DFwtaWHBzhKUmr5vlJuTyIAmgNWiU8BfA0lZBkA8iRVvZo20dF19pBKNFUrQbJ791WKZForZW1aHfmW1i&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:54:36.651  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.654  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.657  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 13:54:36.665  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:54:36.669  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 13:54:36.687  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.691  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 13:54:36.703  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 13:54:36.712  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 13:54:36.774  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (24ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:54:36.790  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 13:54:36.808  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 13:54:36.821  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504243331,
    "exp": 1504243631,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398399514916431.NGRmYjZmMzItMTYzNC00MWRmLWEzZTItYzQzMzU2MGZhZTEzZDdiNWZhNWEtNDJhYy00ZTAyLWIyODMtMjRjNzBkNGJkMTc1",
    "iat": 1504243331,
    "sid": "80bbf4ec982f274c69dc996f8a702518",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504243301,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 13:54:36.824  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.834  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.839  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:54:36.843  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:54:36.846  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:54:36.848  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:54:36.851  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:54:36.860  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aNyUzdpqlXWakI_7GZlAOZcBAzqAgUrB1zpWzbvIBR30wIR53axo_9msv7kx_CRQyCOY-DFwtaWHBzhKUmr5vlJuTyIAmgNWiU8BfA0lZBkA8iRVvZo20dF19pBKNFUrQbJ791WKZForZW1aHfmW1i",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDMzMzEsImV4cCI6MTUwNDI0MzYzMSwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4Mzk5NTE0OTE2NDMxLk5HUm1ZalptTXpJdE1UWXpOQzAwTVdSbUxXRXpaVEl0WXpRek16VTJNR1poWlRFelpEZGlOV1poTldFdE5ESmhZeTAwWlRBeUxXSXlPRE10TWpSak56QmtOR0prTVRjMSIsImlhdCI6MTUwNDI0MzMzMSwic2lkIjoiODBiYmY0ZWM5ODJmMjc0YzY5ZGM5OTZmOGE3MDI1MTgiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDMzMDEsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.gAC6TKJJkMx0gFq8KfCFmmkBj0fMX-i6sXzSCkPF0zktXA-z87nXa48Di2odjodbFYh2cZGwcta1OqykfAzVyUHgfN6hM19stlJNRY9PGta6CrVqDJqZlmhZejkGxs_-pJRMEw05oW_WXp1WG_3nIPkhhqXh-a0iw91oSr0ZJ3jDXD2SxtOo4zA-BgtxmhDK6LwMwh7mN7Omw9kEANcrQIGNvK8_GAcFKn6rK8CR4fpkRkhz9VLnn3gpglGPhNu2qZbVgyXiSmtKEItaDQD28dT4ToZb6vUpvnFXrng7XZpvKjV0Nx38Zb_ovNXro_jhE5Yze1ReORIByzFGdJiJ2Q",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aNyUzdpqlXWakI_7GZlAOZcBAzqAgUrB1zpWzbvIBR30wIR53axo_9msv7kx_CRQyCOY-DFwtaWHBzhKUmr5vlJuTyIAmgNWiU8BfA0lZBkA8iRVvZo20dF19pBKNFUrQbJ791WKZForZW1aHfmW1i",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:54:36.863  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 13:54:36.882  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 235.6418ms 302 
2017-09-01 13:54:36.886  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4YEUDxC2GY0AxssNYPUr2iKbTB1k1YoO4Crk_BSYXEtd_rmrkqRpK9wdG-P-IzXne0ASFBdE_bf6bOS_dPdDrD-geHHTJ5c2KTiplGxoKpwTsGTwoR_tIh0uhMEJEDFuPOwi9Kn0FqbNrmMnWEem2_sOgZ0aSqwdymDpwG_OWhnpC9jhGoumzhh-4MKl6GC7lwpOT7CkXW3Y370D6sJDszfDY2ndZdW7gE6Vvl3Ir-Rkk9f3JAxnuDxyLE2CS2XAEnfBddbtw43K7ra3eXF151hlpUAZ4oP-cqMpd8j4SnyY8a3SGEBNYy4f1IscsBlR1QA8fYMb2C6aN9Aus0JPamkx5eR9BHY-L3XWgtiM6VS0QPVply3SgDLCX3cDnc-K9H3rtnPq7L9CYe68se3uRFrLV6I0d2l0nQfnye-J3QPbzJZl53a66NUYaBtU5YG4dIOHmJV0WK0nq5SQWcXx51C_v84jJnHluuOJ6GlVz_HL9-rKzWAtJo9GcwOw1uwoKvwGv86rIfA4fKhquG7Qlrwe8Wb7djrUjuBoQmj1LWUduV16CYConrrPeuV7kTxM63Zyts3eIqS8W8LMPygXKiucpbwtwrMGwEbO_sPBNB8v3rl2EnsyjBwsPyKbUzmM1czbwoAYkNgTf_Ix05tnppfsXC4dKKmDlIi59vEHk0ccFX7OTCYopdECLNoRKApNlxVPPGIIKCtjsYvMtRVaTplgRo8QcZscqZQ5xHM-YmSMDmB3rqdQ6OTX-C_YI6PYsyHwS8IvkLokLBXD_9jb-uJ2yvJn9ZyPman7rnTUPxYdQ  
2017-09-01 13:54:36.889  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.893  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.955  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4YEUDxC2GY0AxssNYPUr2iKbTB1k1YoO4Crk_BSYXEtd_rmrkqRpK9wdG-P-IzXne0ASFBdE_bf6bOS_dPdDrD-geHHTJ5c2KTiplGxoKpwTsGTwoR_tIh0uhMEJEDFuPOwi9Kn0FqbNrmMnWEem2_sOgZ0aSqwdymDpwG_OWhnpC9jhGoumzhh-4MKl6GC7lwpOT7CkXW3Y370D6sJDszfDY2ndZdW7gE6Vvl3Ir-Rkk9f3JAxnuDxyLE2CS2XAEnfBddbtw43K7ra3eXF151hlpUAZ4oP-cqMpd8j4SnyY8a3SGEBNYy4f1IscsBlR1QA8fYMb2C6aN9Aus0JPamkx5eR9BHY-L3XWgtiM6VS0QPVply3SgDLCX3cDnc-K9H3rtnPq7L9CYe68se3uRFrLV6I0d2l0nQfnye-J3QPbzJZl53a66NUYaBtU5YG4dIOHmJV0WK0nq5SQWcXx51C_v84jJnHluuOJ6GlVz_HL9-rKzWAtJo9GcwOw1uwoKvwGv86rIfA4fKhquG7Qlrwe8Wb7djrUjuBoQmj1LWUduV16CYConrrPeuV7kTxM63Zyts3eIqS8W8LMPygXKiucpbwtwrMGwEbO_sPBNB8v3rl2EnsyjBwsPyKbUzmM1czbwoAYkNgTf_Ix05tnppfsXC4dKKmDlIi59vEHk0ccFX7OTCYopdECLNoRKApNlxVPPGIIKCtjsYvMtRVaTplgRo8QcZscqZQ5xHM-YmSMDmB3rqdQ6OTX-C_YI6PYsyHwS8IvkLokLBXD_9jb-uJ2yvJn9ZyPman7rnTUPxYdQ) - ModelState is Valid
2017-09-01 13:54:36.963  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.981  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.984  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.995  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:36.998  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:37.002  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:54:37.010  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 13:54:37.014  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Error: The view 'LoggedOut' was not found. Searched locations: /Views/Account/LoggedOut.cshtml, /Views/Shared/LoggedOut.cshtml
2017-09-01 13:54:37.019  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 99.8465ms
2017-09-01 13:54:37.063  Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware   Error: An unhandled exception has occurred while executing the request

System.InvalidOperationException: The view 'LoggedOut' was not found. The following locations were searched:
/Views/Account/LoggedOut.cshtml
/Views/Shared/LoggedOut.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOutMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-09-01 13:54:37.136  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 250.0161ms 500 text/html; charset=utf-8
2017-09-01 13:55:43.801  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4YEUDxC2GY0AxssNYPUr2iKbTB1k1YoO4Crk_BSYXEtd_rmrkqRpK9wdG-P-IzXne0ASFBdE_bf6bOS_dPdDrD-geHHTJ5c2KTiplGxoKpwTsGTwoR_tIh0uhMEJEDFuPOwi9Kn0FqbNrmMnWEem2_sOgZ0aSqwdymDpwG_OWhnpC9jhGoumzhh-4MKl6GC7lwpOT7CkXW3Y370D6sJDszfDY2ndZdW7gE6Vvl3Ir-Rkk9f3JAxnuDxyLE2CS2XAEnfBddbtw43K7ra3eXF151hlpUAZ4oP-cqMpd8j4SnyY8a3SGEBNYy4f1IscsBlR1QA8fYMb2C6aN9Aus0JPamkx5eR9BHY-L3XWgtiM6VS0QPVply3SgDLCX3cDnc-K9H3rtnPq7L9CYe68se3uRFrLV6I0d2l0nQfnye-J3QPbzJZl53a66NUYaBtU5YG4dIOHmJV0WK0nq5SQWcXx51C_v84jJnHluuOJ6GlVz_HL9-rKzWAtJo9GcwOw1uwoKvwGv86rIfA4fKhquG7Qlrwe8Wb7djrUjuBoQmj1LWUduV16CYConrrPeuV7kTxM63Zyts3eIqS8W8LMPygXKiucpbwtwrMGwEbO_sPBNB8v3rl2EnsyjBwsPyKbUzmM1czbwoAYkNgTf_Ix05tnppfsXC4dKKmDlIi59vEHk0ccFX7OTCYopdECLNoRKApNlxVPPGIIKCtjsYvMtRVaTplgRo8QcZscqZQ5xHM-YmSMDmB3rqdQ6OTX-C_YI6PYsyHwS8IvkLokLBXD_9jb-uJ2yvJn9ZyPman7rnTUPxYdQ  
2017-09-01 13:55:43.805  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.808  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.811  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4YEUDxC2GY0AxssNYPUr2iKbTB1k1YoO4Crk_BSYXEtd_rmrkqRpK9wdG-P-IzXne0ASFBdE_bf6bOS_dPdDrD-geHHTJ5c2KTiplGxoKpwTsGTwoR_tIh0uhMEJEDFuPOwi9Kn0FqbNrmMnWEem2_sOgZ0aSqwdymDpwG_OWhnpC9jhGoumzhh-4MKl6GC7lwpOT7CkXW3Y370D6sJDszfDY2ndZdW7gE6Vvl3Ir-Rkk9f3JAxnuDxyLE2CS2XAEnfBddbtw43K7ra3eXF151hlpUAZ4oP-cqMpd8j4SnyY8a3SGEBNYy4f1IscsBlR1QA8fYMb2C6aN9Aus0JPamkx5eR9BHY-L3XWgtiM6VS0QPVply3SgDLCX3cDnc-K9H3rtnPq7L9CYe68se3uRFrLV6I0d2l0nQfnye-J3QPbzJZl53a66NUYaBtU5YG4dIOHmJV0WK0nq5SQWcXx51C_v84jJnHluuOJ6GlVz_HL9-rKzWAtJo9GcwOw1uwoKvwGv86rIfA4fKhquG7Qlrwe8Wb7djrUjuBoQmj1LWUduV16CYConrrPeuV7kTxM63Zyts3eIqS8W8LMPygXKiucpbwtwrMGwEbO_sPBNB8v3rl2EnsyjBwsPyKbUzmM1czbwoAYkNgTf_Ix05tnppfsXC4dKKmDlIi59vEHk0ccFX7OTCYopdECLNoRKApNlxVPPGIIKCtjsYvMtRVaTplgRo8QcZscqZQ5xHM-YmSMDmB3rqdQ6OTX-C_YI6PYsyHwS8IvkLokLBXD_9jb-uJ2yvJn9ZyPman7rnTUPxYdQ) - ModelState is Valid
2017-09-01 13:55:43.820  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.823  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.825  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.828  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.831  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.835  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:43.837  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 13:55:44.128  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 13:55:44.140  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 329.5325ms
2017-09-01 13:55:44.144  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 342.3195ms 200 text/html; charset=utf-8
2017-09-01 13:55:44.170  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4b2wFlR0FK2fxFpbtt1CvchkGTw_ukaWbc35gtrYpSw-cA8bX-agKyMj2v13D-bDq-fWpGh73l38jAgrBO00MYdbga19ciAvdf76r7zyAml7GmeqV0Tg4x72lA_lvl_5sgpniMh69HjFKf3jZFn-v_9b662kaC_6mvrefmW8n1ecuWcl6MKbTPN1I4lv_eB1SDeA6_DIP6_kLEJX8CWinssxB2ln32dh0LquD-bdraee4tszP6nJF-6Hh2mSgkLYMRfYbXns8LPzvcKcZhU3JUY271OAwVx83j_1ki0du3nKg  
2017-09-01 13:55:44.173  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 13:55:44.176  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:55:44.179  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 13:55:44.189  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 13:55:44.211  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:44.218  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 13:55:44.221  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 13:55:44.225  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 13:55:44.259  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 88.774ms 200 text/html; charset=UTF-8
2017-09-01 13:55:52.479  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:55:52.482  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 13:55:52.488  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:55:52.490  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 13:55:52.501  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 13:55:52.512  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 13:55:52.520  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:55:52.530  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:52.535  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.538  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.540  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:55:52.543  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.545  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.581  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:52.591  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:52.602  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:52.606  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:52.616  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:55:52.631  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
  "Nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:55:52.642  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 13:55:52.649  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 169.724ms 302 
2017-09-01 13:55:52.654  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:55:52.663  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:55:52.682  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:55:52.688  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:52.691  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.695  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.699  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:55:52.702  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.705  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:52.708  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:52.711  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:52.714  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:52.718  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:52.721  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:55:52.727  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:53.183  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 13:55:53.218  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 554.5092ms
2017-09-01 13:55:53.224  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 569.1362ms 200 text/html; charset=utf-8
2017-09-01 13:55:55.049  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 13:55:55.089  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 13:55:55.109  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 13:55:55.139  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:55:55.148  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 13:55:55.153  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 13:55:55.158  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 13:55:55.161  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 94.8076ms
2017-09-01 13:55:55.165  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 115.3271ms 302 
2017-09-01 13:55:55.172  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:55:55.176  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.179  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.181  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 13:55:55.186  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:55:55.189  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 13:55:55.200  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 13:55:55.205  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.212  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 13:55:55.215  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:55:55.221  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:55.224  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.227  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.230  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:55:55.233  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.242  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.256  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:55.264  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:55.272  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:55.275  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:55.277  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.280  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:55:55.283  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
  "Nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
  "SessionId": "efa76f2b73ee32a975a04ed7d9b1ee5b",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:55:55.302  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 13:55:55.305  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 13:55:55.309  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 137.4232ms 302 
2017-09-01 13:55:55.314  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 13:55:55.318  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.321  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.331  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 13:55:55.337  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.340  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:55:55.344  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:55.348  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.352  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.355  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:55:55.358  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.361  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:55:55.364  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:55.367  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:55.371  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:55.374  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:55.377  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:55:55.380  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:55:55.383  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:55:55.387  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:55:55.390  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:55:55.815  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 13:55:56.127  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 797.9283ms
2017-09-01 13:55:56.131  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 816.8547ms 200 text/html; charset=utf-8
2017-09-01 13:56:01.130  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 13:56:01.135  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.138  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.156  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 13:56:01.163  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.166  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:56:01.170  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:56:01.174  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.176  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.180  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:56:01.182  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.184  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.188  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:56:01.192  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:56:01.196  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:56:01.200  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:56:01.202  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.205  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:56:01.211  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.225  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 13:56:01.229  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 80.1587ms
2017-09-01 13:56:01.231  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 101.5983ms 302 
2017-09-01 13:56:01.237  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:56:01.240  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.242  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.246  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 13:56:01.251  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 13:56:01.253  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 13:56:01.256  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 13:56:01.258  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.264  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 13:56:01.267  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 13:56:01.271  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:56:01.273  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.277  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.281  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:56:01.284  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.287  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 13:56:01.290  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:56:01.294  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:56:01.299  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 13:56:01.302  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 13:56:01.305  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.307  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 13:56:01.312  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
  "Nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
  "SessionId": "efa76f2b73ee32a975a04ed7d9b1ee5b",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:56:01.315  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 13:56:01.323  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 13:56:01.328  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 13:56:01.354  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 13:56:01.368  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 13:56:01.375  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 13:56:01.380  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 13:56:01.416  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZdIi6sbd7PafTWouzZL0CQmccdLu86vgMoYY2mNrJZBAWBsruPgH6iX991EQS9tHRV0uPIwzo9R6pzeOsIYxQCZWS-VsaPs8GH5T8SyMhAMxop-mfsEoPL3qcTLhiyuIVOXJxzIHNiXFJcgC01615W66Lh-s57W6f7-yzNGY8nn6nh_Ce7eYXSYQdKTZhSCOcztcDz8Z2VuM_I1YIsuX1aTs2RBzL7_1Tnsjl-MKKnxkOF7L7WsBxwygxciEo7EM5XAhHmHFU2wPc8mjKIFv0sBD-rwz7_AmT9irz3F39ay-1xCpREdk-zDRzoC82eP8c",
  "Scope": "openid"
}
2017-09-01 13:56:01.428  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.437  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:01.440  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 13:56:01.442  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 13:56:01.451  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 214.172ms 200 text/html; charset=UTF-8
2017-09-01 13:56:29.910  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDUzNjEsImV4cCI6MTUwNDI0NTY2MSwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDIxNTI0NjY2ODg1Lk9UTTJOMlZtWlRndFpXRmhZUzAwWm1NeExUazJPV0V0WlRZMFlXTTBaalJqWXpsbFpXWmlOalExWldZdE9HWTFZaTAwTW1VMExUazBOR1V0T0daak5URm1NbVptWWpWbSIsImlhdCI6MTUwNDI0NTM2MSwic2lkIjoiZWZhNzZmMmI3M2VlMzJhOTc1YTA0ZWQ3ZDliMWVlNWIiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDUzNTUsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.ih5ICLKPP_cjPdAhsmW4F5qwDHLv2NhR_4otgtjArJQHZa4tFxUUNgnlUeghfb0GyUafn_cgVFwjDP4-0ooJZG5eH7J7clNF6LPw-5ZBXAP5JzSpepphWAxPZS-_K8f-2PWbLhA9YFl7aGDj81-YDSs2RlzKjDd_VBpGkllHEtB1JMY7UT_n2r_ypveDBsX0cTXykexez7k3jq6FbKGUVjy6YH_jnwTW07D5BKSEIDxber13W4hYY0DrS9zeqZXyRobQtNUL1kKXjQKIjW9493ggG0vYcAvEHTvH158q9daDfJ4cYgF19YoVWoeTctWCYRQ_3K3U0AjcmkKbRwVZtQ&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bOf1oeDOcFi1W0mfD1BvTB4Ea3lz9wz_5VGWEu-rcYfQ-ATCLtr0yerjqB72dagv91PHEYYdPclBsF61KEoGb6JnNWgFq2hwVOxnFZdbhRIlKOVf5psPYChvQy6rnXwLxX4AxwIlccQN6mWjk3vjM_&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 13:56:29.914  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:29.918  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:29.921  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 13:56:29.924  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:56:29.928  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 13:56:29.931  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:29.933  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 13:56:29.936  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 13:56:29.940  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 13:56:29.947  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:56:29.950  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 13:56:29.954  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 13:56:29.957  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504245361,
    "exp": 1504245661,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398421524666885.OTM2N2VmZTgtZWFhYS00ZmMxLTk2OWEtZTY0YWM0ZjRjYzllZWZiNjQ1ZWYtOGY1Yi00MmU0LTk0NGUtOGZjNTFmMmZmYjVm",
    "iat": 1504245361,
    "sid": "efa76f2b73ee32a975a04ed7d9b1ee5b",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504245355,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 13:56:29.961  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:29.963  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:29.967  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:56:29.970  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:56:29.973  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 13:56:29.976  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:56:29.979  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 13:56:29.983  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bOf1oeDOcFi1W0mfD1BvTB4Ea3lz9wz_5VGWEu-rcYfQ-ATCLtr0yerjqB72dagv91PHEYYdPclBsF61KEoGb6JnNWgFq2hwVOxnFZdbhRIlKOVf5psPYChvQy6rnXwLxX4AxwIlccQN6mWjk3vjM_",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDUzNjEsImV4cCI6MTUwNDI0NTY2MSwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDIxNTI0NjY2ODg1Lk9UTTJOMlZtWlRndFpXRmhZUzAwWm1NeExUazJPV0V0WlRZMFlXTTBaalJqWXpsbFpXWmlOalExWldZdE9HWTFZaTAwTW1VMExUazBOR1V0T0daak5URm1NbVptWWpWbSIsImlhdCI6MTUwNDI0NTM2MSwic2lkIjoiZWZhNzZmMmI3M2VlMzJhOTc1YTA0ZWQ3ZDliMWVlNWIiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDUzNTUsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.ih5ICLKPP_cjPdAhsmW4F5qwDHLv2NhR_4otgtjArJQHZa4tFxUUNgnlUeghfb0GyUafn_cgVFwjDP4-0ooJZG5eH7J7clNF6LPw-5ZBXAP5JzSpepphWAxPZS-_K8f-2PWbLhA9YFl7aGDj81-YDSs2RlzKjDd_VBpGkllHEtB1JMY7UT_n2r_ypveDBsX0cTXykexez7k3jq6FbKGUVjy6YH_jnwTW07D5BKSEIDxber13W4hYY0DrS9zeqZXyRobQtNUL1kKXjQKIjW9493ggG0vYcAvEHTvH158q9daDfJ4cYgF19YoVWoeTctWCYRQ_3K3U0AjcmkKbRwVZtQ",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bOf1oeDOcFi1W0mfD1BvTB4Ea3lz9wz_5VGWEu-rcYfQ-ATCLtr0yerjqB72dagv91PHEYYdPclBsF61KEoGb6JnNWgFq2hwVOxnFZdbhRIlKOVf5psPYChvQy6rnXwLxX4AxwIlccQN6mWjk3vjM_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 13:56:29.986  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 13:56:29.989  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 78.9575ms 302 
2017-09-01 13:56:29.994  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 13:56:29.997  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.001  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.004  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 13:56:30.007  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.010  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.013  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.016  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.020  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.022  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 13:56:30.025  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 13:56:30.028  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 13:56:30.031  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 27.0777ms
2017-09-01 13:56:30.035  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 41.8048ms 200 text/html; charset=utf-8
2017-09-01 13:56:30.063  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4br-srSeF2fCpdFhAzf-XzO6_Wlrpjb07qGCAjPxLbeBY7t4GWwvPB8iVokV3mnXy8jFBpCvmGjm6YkPeuDZlFRk9T6Hm-5LYv5r__gfbSXxA48wptQFZ7HfZTkAQDOrhofx5yUqO24lY6veVym0GaKhATpZfu4M5bi5LwWDi3aNn7E0ELmi-smxFq2F7g-VTjcVfDtOOTgkanB2PFtAfFkXAIlNGfLX15nqTc4LNEVj0mLoX5fxQcVSrkJLcLaBhIRQCODPgNixRx-CBU1GswiDHNr8vyeyUS6Bj2crLPSyQ  
2017-09-01 13:56:30.067  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 13:56:30.070  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:56:30.072  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 13:56:30.080  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 13:56:30.084  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:56:30.086  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 13:56:30.089  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 13:56:30.091  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 13:56:30.096  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 33.6385ms 200 text/html; charset=UTF-8
2017-09-01 13:59:38.320  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 13:59:38.327  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 13:59:38.330  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 13:59:38.470  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 13:59:38.480  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 154.019ms
2017-09-01 13:59:38.484  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 163.2482ms 200 text/html; charset=utf-8
2017-09-01 13:59:38.502  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTfPZmQJlHtidqofULWPJJsekCIxuM2d_A9siYbGZBIPzODnNl6iwBKmtij4Cv0z3BFYomtD2E1swBVuEVsUR0UGF60E09dAbQ7kAt9bhhfQQ-LHtAEG336kkIvZimRHDrgAITeUD331NGJx8csKUUTUrgqjay9FkVuwzSempB8KW73ofmotTURBeB3X75_qfaWKGgQxNZspwujnewqYXCclAGkrd_eAXwu8RogK4Bc7GlwUAZhE8WEiT2JVttzeAztCQkr8CS_xjqUILfaohsfT8ixf28dfTQn0EP4c26Dg  
2017-09-01 13:59:38.507  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 13:59:38.510  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:59:38.514  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 13:59:38.517  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 13:59:38.525  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:59:38.528  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 13:59:38.530  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 13:59:38.533  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 13:59:38.537  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 34.5885ms 200 text/html; charset=UTF-8
2017-09-01 13:59:47.142  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 13:59:47.147  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 13:59:47.150  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 13:59:47.287  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 13:59:47.296  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 150.0147ms
2017-09-01 13:59:47.300  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 157.4562ms 200 text/html; charset=utf-8
2017-09-01 13:59:47.317  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4axySmnEDR7oMfqCemAP-rihvYYmj7PgtP9-WuTm2lqj5FKogGf2V-reugj71aLy58v88zewUXEOXZ5gjvz9-cZbCezLNmoWubTiUqoCUtaW4Wmqn4tsgYyqmKc52t4x0gVnqn2DNgSYDs4ujgT0E86OWK8aI511PLAp6evT2Ph7a9Dg_EGw8ZCMDXeMsP99NqBS80Cn325hWYfAgttF5Dz2gwQYI7aWgQumJ-LmsSEAc93Kt1Glf-NYOSY7pNpwWSXPiDhU1ob4Kuyd0n_J_KWPFWU4KpB0LRfl6-pMUPRUw  
2017-09-01 13:59:47.321  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 13:59:47.324  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 13:59:47.329  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 13:59:47.333  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 13:59:47.336  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 13:59:47.339  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 13:59:47.342  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 13:59:47.346  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 13:59:47.349  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 32.023ms 200 text/html; charset=UTF-8
2017-09-01 14:00:09.263  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:00:09.267  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:00:09.272  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:00:09.411  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:00:09.421  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 153.7123ms
2017-09-01 14:00:09.424  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 161.3934ms 200 text/html; charset=utf-8
2017-09-01 14:00:09.443  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4bvNz7e9SlloHzfFhhr-qwK7dOkVApqStle6HfXdj4dtp9CMxtB7sTmmRVxtwCVOAPg5m7nVwk7h9909jStwgQMqsCbVMXdvxOXUERRle-c9rf2AUB48M9i6lo4M-7PAIAWXFKxy--cbUH4kJ7qNqwsR06gNR1mCYkt_QvfcV_mCMjmkVMUDCBs0ML4hkLEiR5-xfKKC9frybED9QGtR--Or3r1dBD7tOCWNDPiP6JLCPWMH2fEKUrT3YbccmhBQT7RCksQLGUvpqCbLN1GNjYzX6WmLEiVH0QjtKJQb1G4yA  
2017-09-01 14:00:09.447  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:00:09.450  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:00:09.455  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:00:09.459  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:00:09.465  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:00:09.469  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:00:09.473  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:00:09.476  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:00:09.479  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 35.2347ms 200 text/html; charset=UTF-8
2017-09-01 14:00:27.965  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:00:27.976  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:00:27.986  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:00:28.274  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:00:28.288  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 312.6811ms
2017-09-01 14:00:28.293  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 327.9291ms 200 text/html; charset=utf-8
2017-09-01 14:00:28.325  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4bbeSYmtvYWZR3b0-OpAsSF0Sa1zGgvDr8aXIVwYSrO3gczFq0-NHuGUQrGmc0nMQTHpWiOkIwzSgYnRAQ6l3mVifGcgHgtoSh5888FiYjAG0DBfIQ4n7JLZxerNxi-DFZ1nXnuVxhdZwXGCiZ8uIvsZ_p3PLwzJssUXK3I2SMntyrAJCM-huVxmws12PIJqWEx_xVoIk1YxGkAkh4ZRPPaV8-x8Mr2oZNMonbNiYj8Qh6Zf4pPB6_Tq035OwX68zEB-pfxHns9RYHnTsHD4dkUZhEfyY8VCUn0D_3dgs1UtQ  
2017-09-01 14:00:28.334  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:00:28.337  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:00:28.339  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:00:28.342  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:00:28.349  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:00:28.352  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:00:28.355  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:00:28.359  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:00:28.361  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 37.0122ms 200 text/html; charset=UTF-8
2017-09-01 14:00:35.421  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:00:35.426  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:00:35.430  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:00:35.563  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:00:35.573  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 147.1358ms
2017-09-01 14:00:35.577  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 155.9337ms 200 text/html; charset=utf-8
2017-09-01 14:00:35.596  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4adMytTw1_wrqPxq2XVaRhC_277x_JhJbzDwPHehuvCX4dSyIeciHthZKGMtukDn9scy14_jp-afsxs70JY0n3shEUeahZsL1HpdmdPWBU18GCH7VlmPfuBzaiiJfo1PB-Zq5DsaBWYbCH1-xkrl5JoxmmH7SlUWbtPThmmIk-lTMJ60M0s9bZRdBUhLgKFSWQ3vTxs_d6SiGsez9aWDJevf0lREYC5r2XBQ8ZHfR7fx6I_SMonWc4Q0bz2lr9UYv2CmTfmMZZC1UFtLy8WjbdxxPR7Wzr5iL38XU4Nr7HiRw  
2017-09-01 14:00:35.600  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:00:35.602  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:00:35.608  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:00:35.611  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:00:35.617  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:00:35.620  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:00:35.624  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:00:35.627  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:00:35.630  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 34.5792ms 200 text/html; charset=UTF-8
2017-09-01 14:00:51.870  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:00:51.875  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:00:51.879  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:00:52.010  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:00:52.020  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 144.4857ms
2017-09-01 14:00:52.024  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 153.3544ms 200 text/html; charset=utf-8
2017-09-01 14:00:52.040  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4ZtttTsQtwLoQtPTFU5tz6DAdyCX-9Om5szv1nbC4kDJRAAIPPKLUerOzIUOpfFR86XAhvfQ7oOL7HHJthfwD5W-6a7VIS9OgBQ8M4cyC5-66I9dmp63VbnDE8WUlRiHQJX7y0YbGnxS308esKqNre9LbBVmz5A1PJih5A940-gXbYnbergVn0RThogk-Z6B4VyadUUKfP582kRJX5W7Or8l7yPxqhLE9IIdLZYDZ2hrsL_MrGEBHMseubtqEjdnuTuchKCYTQ3cFGPPXDslf_bIBUmJklkPtkMsSr1qAjcbQ  
2017-09-01 14:00:52.044  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:00:52.049  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:00:52.053  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:00:52.058  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:00:52.064  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:00:52.070  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:00:52.073  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:00:52.076  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:00:52.079  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 38.4266ms 200 text/html; charset=UTF-8
2017-09-01 14:01:43.278  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:01:43.283  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:01:43.286  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:01:43.419  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:01:43.428  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 145.0139ms
2017-09-01 14:01:43.432  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 153.4885ms 200 text/html; charset=utf-8
2017-09-01 14:01:43.453  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/simple-line-icons/simple-line-icons.min.css  
2017-09-01 14:01:43.455  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/font-awesome/css/font-awesome.css  
2017-09-01 14:01:43.456  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/uniform/css/uniform.default.min.css  
2017-09-01 14:01:43.457  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap/dist/css/bootstrap.min.css  
2017-09-01 14:01:43.458  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/css/select2.min.css  
2017-09-01 14:01:43.459  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/simple-line-icons/simple-line-icons.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\simple-line-icons\simple-line-icons.min.css'
2017-09-01 14:01:43.460  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-switch/css/bootstrap-switch.min.css  
2017-09-01 14:01:43.462  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/font-awesome/css/font-awesome.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\font-awesome\css\font-awesome.css'
2017-09-01 14:01:43.463  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/uniform/css/uniform.default.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\uniform\css\uniform.default.min.css'
2017-09-01 14:01:43.466  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap\dist\css\bootstrap.min.css'
2017-09-01 14:01:43.469  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/css/select2.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\css\select2.min.css'
2017-09-01 14:01:43.471  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 19.3068ms 200 text/css
2017-09-01 14:01:43.475  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-switch/css/bootstrap-switch.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-switch\css\bootstrap-switch.min.css'
2017-09-01 14:01:43.478  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 23.7658ms 200 text/css
2017-09-01 14:01:43.481  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 24.6655ms 200 text/css
2017-09-01 14:01:43.487  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 29.4931ms 200 text/css
2017-09-01 14:01:43.489  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 31.9431ms 200 text/css
2017-09-01 14:01:43.496  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/css/select2-bootstrap.min.css  
2017-09-01 14:01:43.499  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 39.0251ms 200 text/css
2017-09-01 14:01:43.505  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/css/plugins.min.css  
2017-09-01 14:01:43.508  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/css/components.min.css  
2017-09-01 14:01:43.514  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/pages/css/login-5.min.css  
2017-09-01 14:01:43.516  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery/dist/jquery.min.js  
2017-09-01 14:01:43.517  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/css/select2-bootstrap.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\css\select2-bootstrap.min.css'
2017-09-01 14:01:43.520  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4aJSjixMnxsQuK3PwaPdguq5n4DGBJPZn60qG70YgAOoJd11pjt_GsElIIntmHgfpGTtIMFicB7_j5uIGIQfAO14EFb72I6LCXEzs07Y_GVbZfpr1uVR9qzBsJ0TtEXOa9UN8ZR07w_lsTTvMFLZN1LanrWlb-cmFCG8w35cwA5Ada2GMd8D2xE2spmfcI2slHEMV7odxywLusl53qaB7EJZeh6Dn8FUeuXZJCxevY2pZ3XaYhju66k7goQM_6WxM3KpbP4_4vVFC9_K3Bky6Rzq1W1jXXGkFFiGhT7_2d-jg  
2017-09-01 14:01:43.524  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/css/plugins.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\css\plugins.min.css'
2017-09-01 14:01:43.527  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/css/components.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\css\components.min.css'
2017-09-01 14:01:43.532  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/pages/css/login-5.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\pages\css\login-5.min.css'
2017-09-01 14:01:43.534  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery/dist/jquery.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery\dist\jquery.min.js'
2017-09-01 14:01:43.536  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 40.2804ms 200 text/css
2017-09-01 14:01:43.538  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:01:43.543  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 38.3599ms 200 text/css
2017-09-01 14:01:43.551  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 36.9731ms 200 text/css
2017-09-01 14:01:43.555  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 38.757ms 200 application/javascript
2017-09-01 14:01:43.563  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 55.0874ms 200 text/css
2017-09-01 14:01:43.564  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap/dist/js/bootstrap.min.js  
2017-09-01 14:01:43.572  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:01:43.577  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/js.cookie.min.js  
2017-09-01 14:01:43.580  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js  
2017-09-01 14:01:43.582  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-slimscroll/jquery.slimscroll.min.js  
2017-09-01 14:01:43.586  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap\dist\js\bootstrap.min.js'
2017-09-01 14:01:43.593  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:01:43.603  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/js.cookie.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\js.cookie.min.js'
2017-09-01 14:01:43.607  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-hover-dropdown\bootstrap-hover-dropdown.min.js'
2017-09-01 14:01:43.611  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-slimscroll/jquery.slimscroll.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-slimscroll\jquery.slimscroll.min.js'
2017-09-01 14:01:43.616  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 51.7467ms 200 application/javascript
2017-09-01 14:01:43.619  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:01:43.628  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 51.1335ms 200 application/javascript
2017-09-01 14:01:43.635  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 55.2212ms 200 application/javascript
2017-09-01 14:01:43.636  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery.blockui.min.js  
2017-09-01 14:01:43.637  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 54.7452ms 200 application/javascript
2017-09-01 14:01:43.649  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:01:43.656  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/uniform/jquery.uniform.min.js  
2017-09-01 14:01:43.658  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-validation/dist/jquery.validate.min.js  
2017-09-01 14:01:43.660  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-validation/dist/additional-methods.min.js  
2017-09-01 14:01:43.662  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery.blockui.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery.blockui.min.js'
2017-09-01 14:01:43.664  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-switch/js/bootstrap-switch.min.js  
2017-09-01 14:01:43.669  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:01:43.672  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/uniform/jquery.uniform.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\uniform\jquery.uniform.min.js'
2017-09-01 14:01:43.675  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-validation/dist/jquery.validate.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-validation\dist\jquery.validate.min.js'
2017-09-01 14:01:43.678  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-validation/dist/additional-methods.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-validation\dist\additional-methods.min.js'
2017-09-01 14:01:43.680  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 43.5313ms 200 application/javascript
2017-09-01 14:01:43.682  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-switch/js/bootstrap-switch.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-switch\js\bootstrap-switch.min.js'
2017-09-01 14:01:43.688  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:01:43.690  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 34.1491ms 200 application/javascript
2017-09-01 14:01:43.693  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 35.5907ms 200 application/javascript
2017-09-01 14:01:43.696  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 36.1151ms 200 application/javascript
2017-09-01 14:01:43.702  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/js/select2.full.min.js  
2017-09-01 14:01:43.708  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 44.1327ms 200 application/javascript
2017-09-01 14:01:43.712  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:01:43.715  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/backstretch/jquery.backstretch.min.js  
2017-09-01 14:01:43.719  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/js/app.min.js  
2017-09-01 14:01:43.723  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/pages/js/login-5.min.js  
2017-09-01 14:01:43.734  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/js/select2.full.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\js\select2.full.min.js'
2017-09-01 14:01:43.749  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg1.jpg  
2017-09-01 14:01:43.755  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 234.1687ms 200 text/html; charset=UTF-8
2017-09-01 14:01:43.759  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/backstretch/jquery.backstretch.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\backstretch\jquery.backstretch.min.js'
2017-09-01 14:01:43.770  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/js/app.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\js\app.min.js'
2017-09-01 14:01:43.777  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/pages/js/login-5.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\pages\js\login-5.min.js'
2017-09-01 14:01:43.782  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 78.938ms 200 application/javascript
2017-09-01 14:01:43.783  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg1.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg1.jpg'
2017-09-01 14:01:43.787  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/simple-line-icons/fonts/Simple-Line-Icons.woff  
2017-09-01 14:01:43.793  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 77.1618ms 200 application/javascript
2017-09-01 14:01:43.799  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 80.3261ms 200 application/javascript
2017-09-01 14:01:43.802  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 79.4791ms 200 application/javascript
2017-09-01 14:01:43.817  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/simple-line-icons/fonts/Simple-Line-Icons.woff'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\simple-line-icons\fonts\Simple-Line-Icons.woff'
2017-09-01 14:01:43.822  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 76.3981ms 200 image/jpeg
2017-09-01 14:01:43.833  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 46.0452ms 200 application/font-woff
2017-09-01 14:01:43.869  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg2.jpg  
2017-09-01 14:01:43.870  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg3.jpg  
2017-09-01 14:01:43.874  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg2.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg2.jpg'
2017-09-01 14:01:43.876  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg3.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg3.jpg'
2017-09-01 14:01:43.883  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 12.8579ms 200 image/jpeg
2017-09-01 14:01:43.892  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 21.522ms 200 image/jpeg
2017-09-01 14:01:43.970  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/favicon.ico  
2017-09-01 14:01:43.978  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 7.9784ms 404 
2017-09-01 14:02:37.742  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:02:37.745  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:02:37.752  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:02:37.898  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:02:38.171  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 426.0014ms
2017-09-01 14:02:38.175  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 432.9949ms 200 text/html; charset=utf-8
2017-09-01 14:02:38.237  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4aZQ85vFaFl7EcjkTch9JUWK-Q0LfOgdRAeGmym1we3BnoFWTH4tMkAXsJ9OJX4qtNkeu71g9Nnda3ePMEEqA7A-dlztwOzKbt14LPG1up9qZQlfk7X7T_YR0jL3VlBrQi63W1DMDTV2WyYaZEFJoPk3nfNyg1pTkQCENKeQLu2IaFp1OcuZFDwP6798fUeV3TmeZEDUrxgrKvU5Esvy8Qw3Dolc6oDdPNS7IDBO9RJHlQzjIxDsNLY9BaEyhD82ukGLihB61knbCpkRPb1BqRhRY9kjD8d0BzTNhxyt3tQ8g  
2017-09-01 14:02:38.242  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:02:38.253  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:02:38.271  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:02:38.281  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:02:38.300  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (9ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:02:38.306  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:02:38.309  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:02:38.313  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:02:38.317  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 79.4146ms 200 text/html; charset=UTF-8
2017-09-01 14:02:45.979  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:02:45.983  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:02:45.987  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:02:46.123  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:02:46.132  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 149.3062ms
2017-09-01 14:02:46.137  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 157.5069ms 200 text/html; charset=utf-8
2017-09-01 14:02:46.157  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4a0dvQFw6PXkosdMaYMnQoEybhGwextMDtAIwWhny26XEjTIx51S-ldVyq-NjV2t7v1oDIOKTSH3bF4txtzOjEdBGQfv8DvE_qOBS9q9igW1G2Ug8neyVhTq1kQbTIbKSi347GXM_g9-zpxhk-DDgv6BerLdzcvj-qvJ5QGfR5aZyCjmcjzHmYoLfyckwRegPsIGsBj74e4RReexuqUcrJplPLBAVlXlq3o6LtujyqnlshADErtqTqJiRw5trWq8iCKrCLWc3VOI-KPBazlPp7aiyz9515NSykGm6reSlcvYw  
2017-09-01 14:02:46.160  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:02:46.163  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:02:46.170  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:02:46.173  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:02:46.177  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:02:46.180  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:02:46.182  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:02:46.187  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:02:46.190  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 33.1105ms 200 text/html; charset=UTF-8
2017-09-01 14:02:52.750  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ  
2017-09-01 14:02:52.754  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Y5-Gqls_F5jdtoQakHLmzDzABI38cfgZ1P-vL-Ujat_CgoG67buUNWKAL8Kpl7ThDuM9nZiZFVRKtjVXapFtOJdor2jaBhOxCED8cTEhh_Ozr3X1B6c40XCVHEQ_d-MsPHwv33GA5lrqVcLbUZjlwRsRALp5EKibcyX9IChKMdQ6EOVPNbuEfUA5cRfFM35A6Di0WK8RZUDlrIt3-iJ9urzSWKV4N9kI8FZtJB9cH-uOwAc9q6mBGe8CRiGZmEoXALbgxG7M5obx2_NEMzIDKIPeBvs42MdV9en8H22DueWwvKZhRyhl-RurKuPvcumR8nVtZu6zYDlMyOC9-SKQBhnv7939DZF8OQKvQjBgbPawe1i5rqhgmlU9sSuY4YD-0kCf9qLjJwmKRGUhGwcxT6FihHdvZdQZTLYChwRFGldrltd9g7GwiACaJTbiqowM814vzcO4jvB6t3B3zy7Jsb58wm8ibf3DqbRzDRRBQTi0XhNzvxFkj0CzwjvSbrteUlLm2K7u81bittFC_Ew7hzXAWJNKIzt-sv0wvF09w-G4jflpXAmAOp_BLT6U_VMl8bLB9_81KrHzj6bOKGk6mA8laqRCxbVIm4yjvCqw9r9bSzyHs7J2ZztVxqwim95Nly7sQm54iKaqC5rLPsl54Mr3OOrwLpCGqPFKb1JUCqBad9gml2fwJMUqH2ycxz6x4PDx57KqO0BMseni-7a0ry3y8fK5wNv20McG6unUNNtaCSw51CQdJnlWNJ2CFbKy6cD6mgWO3zgYT8ZrmsLGEMd3ar6WUz9v9bu4g1HlfjmQ) - ModelState is Valid
2017-09-01 14:02:52.757  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:02:52.898  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:02:52.906  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 152.4073ms
2017-09-01 14:02:52.912  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 161.7122ms 200 text/html; charset=utf-8
2017-09-01 14:02:52.931  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4bxUnh5EaCEyGpJyr4Obs-fneDb9gafb5x2JzwODPUu_lHfLWLbMkXNg0PFwlxCJPCJoNEhxE6BpDsMVqknEV4yCQ53x-N8ypD5AlaHjujfpa4Re8pG-L6_nRXHJBrKiwNUBk07_GVW2BZMsShQ1nMCNltVP1GGpMHs6WsMAowf78gNzNKGFf29uRLdEMPxD21cy3VEMmZlgRj6hDdZGJ8cj_TPkxgt5D9OQFx_WMq6Wlg9Hb3sYt_kpIab91c-eKlHp4EKnrvBaWHmvU8E_HyneQaOcuREACBoAjlNI9D4fw  
2017-09-01 14:02:52.935  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:02:52.938  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:02:52.941  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:02:52.946  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:02:52.952  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:02:52.955  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:02:52.958  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:02:52.962  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:02:52.965  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 33.8675ms 200 text/html; charset=UTF-8
2017-09-01 14:06:03.645  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 14:06:03.652  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 14:06:03.677  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 14:06:04.032  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:06:04.079  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 14:06:04.092  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:06:04.096  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 14:06:04.108  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 14:06:04.126  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 14:06:04.137  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:04.346  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (37ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:04.393  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.396  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.399  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:04.402  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.405  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.442  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:04.461  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:04.486  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:04.490  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:04.503  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:04.525  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
  "Nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:06:04.538  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 14:06:04.551  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 530.8927ms 302 
2017-09-01 14:06:04.560  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:06:04.714  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:06:04.733  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:04.740  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:04.746  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.751  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.755  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:04.758  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.761  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:04.766  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:04.770  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:04.773  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:04.777  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:04.780  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:04.786  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:07.506  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 14:06:07.875  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3201.4622ms
2017-09-01 14:06:07.892  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3331.9883ms 200 text/html; charset=utf-8
2017-09-01 14:06:09.434  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 14:06:09.473  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 14:06:09.493  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 14:06:09.527  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:06:09.538  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:06:09.542  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 14:06:09.547  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:06:09.550  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 97.1777ms
2017-09-01 14:06:09.554  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 120.4834ms 302 
2017-09-01 14:06:09.561  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:06:09.566  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.570  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.573  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:06:09.576  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:06:09.581  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:06:09.590  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:06:09.593  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.603  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:06:09.607  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:09.617  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (5ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:09.620  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.623  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.627  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:09.630  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.633  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.639  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:09.644  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:09.651  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:09.657  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:09.660  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.663  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:09.666  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
  "Nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
  "SessionId": "1e18b0f82ebc4e6a841b79f396454c3c",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:06:09.684  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:06:09.687  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 14:06:09.692  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 131.9196ms 302 
2017-09-01 14:06:09.700  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:06:09.705  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.708  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.721  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:06:09.729  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.734  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:09.755  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:09.758  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.761  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.767  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:09.771  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.774  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:09.781  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:09.785  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:09.789  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:09.792  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:09.796  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:09.799  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:09.805  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:09.809  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:09.814  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:10.269  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 14:06:10.593  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 874.322ms
2017-09-01 14:06:10.598  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 898.3137ms 200 text/html; charset=utf-8
2017-09-01 14:06:14.210  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 14:06:14.215  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.218  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.233  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 14:06:14.240  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.245  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:14.251  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:14.254  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.258  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.261  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:14.264  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.266  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.271  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:14.276  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:14.280  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:14.283  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:14.285  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.287  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:14.293  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.310  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:06:14.313  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 85.9292ms
2017-09-01 14:06:14.316  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 105.6138ms 302 
2017-09-01 14:06:14.321  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:06:14.325  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.329  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.332  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:06:14.334  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:06:14.337  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:06:14.339  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:06:14.342  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.349  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:06:14.352  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:06:14.356  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:14.361  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.363  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.366  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:14.369  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.374  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:06:14.377  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:14.380  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:14.384  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:06:14.387  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:06:14.391  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.394  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:06:14.397  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
  "Nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
  "SessionId": "1e18b0f82ebc4e6a841b79f396454c3c",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:06:14.400  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:06:14.408  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 14:06:14.412  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 14:06:14.434  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 14:06:14.446  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 14:06:14.453  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 14:06:14.459  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 14:06:14.507  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aTSksqslUcT3Iy2jydjkaSPtBW1XYh_QjAB9mLDad0iJ-DZyXTxTdL3V0P0HwNbAV63oIz9A7JMETeUtAYxVG206DEWkzTeKAeWVSSYaEzBV3fM8ChcbmH2hBg608F-03xKOumSkcRzetU_B_OEWzzVuaeJMrRtiZrG8pMeUz4GXZewrhRcp6IgcS-JA20WUkrUqwYIL1icmLiT8TG6mAh9k_P5-RLnhllBKoyVot-pt1VFWfLuW87rO20DB8c118j25zmqWLl_C01-g9ducKKcQlUbt3TKGeFphqv6PpqTkiiZmOpDoNYjePwXq7LPas",
  "Scope": "openid"
}
2017-09-01 14:06:14.529  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.539  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:14.542  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:06:14.545  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:06:14.556  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 234.5462ms 200 text/html; charset=UTF-8
2017-09-01 14:06:17.963  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDU5NzQsImV4cCI6MTUwNDI0NjI3NCwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDI3NjIzODM5Njk4Lk1EWXhNV1l4TWpVdFpqTXlPUzAwWkRFeExUazFNalF0TjJGaU5tTmpNelk1Tm1JME1HVTVNRGsxTm1ZdFpHUTFNQzAwTURkakxXRmpNelF0WmpRNE5UaGhORFkzWWpJMSIsImlhdCI6MTUwNDI0NTk3NCwic2lkIjoiMWUxOGIwZjgyZWJjNGU2YTg0MWI3OWYzOTY0NTRjM2MiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDU5NjksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.c08gzuPE5Qd_nXzlQoEGEwAdFyg76PdMzuWbXBBYCnMTyuYEZEckypvjgPw-4Voo8j1ww9L72d2K7_pZsUlQ_jDBhcQM7tCU1l9XIdA5x4hAaNoyMWHtdfVuko4hPsJws7QGITuTHk5S3lSuO5EBFqkD_QoUvxSrL16yIUrANOZBt3k-wh19Ddgedpu4EpxBbzNUObYeBiNABq1Nv7Ihf_lfGuGTvYSYfothZMxbjIqWo-nACnwu8ww5wiEHnedzjO8W_hLgkWRdQqhTEEUvVB_VTnhe0UkYTPB1Ob7GhGIb52hl8tw7CgiNEeuznSvmT3kxwwX11JoAlcBusTabEA&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bBxZeDufxXKxdlEvYnMSa7mNeJKZvjtDsu5ZobAfUAluIKehNx0OQP-0tfUOW_oUB1N2zNsNEZ_07GS4dinkjm9zUSdsl-zW3nQgiZPP1f5nZAVNrq9gmepsC11Y8TUTzCTt-R-_5NRHO51uPkq_jG&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:06:17.967  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:17.972  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:17.975  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 14:06:17.979  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:06:17.982  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 14:06:17.994  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:17.998  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 14:06:18.008  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 14:06:18.017  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 14:06:18.022  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:18.026  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 14:06:18.040  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 14:06:18.055  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504245974,
    "exp": 1504246274,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398427623839698.MDYxMWYxMjUtZjMyOS00ZDExLTk1MjQtN2FiNmNjMzY5NmI0MGU5MDk1NmYtZGQ1MC00MDdjLWFjMzQtZjQ4NThhNDY3YjI1",
    "iat": 1504245974,
    "sid": "1e18b0f82ebc4e6a841b79f396454c3c",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504245969,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 14:06:18.059  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.062  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.066  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:06:18.068  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:06:18.071  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:06:18.074  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:06:18.076  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:06:18.083  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bBxZeDufxXKxdlEvYnMSa7mNeJKZvjtDsu5ZobAfUAluIKehNx0OQP-0tfUOW_oUB1N2zNsNEZ_07GS4dinkjm9zUSdsl-zW3nQgiZPP1f5nZAVNrq9gmepsC11Y8TUTzCTt-R-_5NRHO51uPkq_jG",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDU5NzQsImV4cCI6MTUwNDI0NjI3NCwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDI3NjIzODM5Njk4Lk1EWXhNV1l4TWpVdFpqTXlPUzAwWkRFeExUazFNalF0TjJGaU5tTmpNelk1Tm1JME1HVTVNRGsxTm1ZdFpHUTFNQzAwTURkakxXRmpNelF0WmpRNE5UaGhORFkzWWpJMSIsImlhdCI6MTUwNDI0NTk3NCwic2lkIjoiMWUxOGIwZjgyZWJjNGU2YTg0MWI3OWYzOTY0NTRjM2MiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDU5NjksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.c08gzuPE5Qd_nXzlQoEGEwAdFyg76PdMzuWbXBBYCnMTyuYEZEckypvjgPw-4Voo8j1ww9L72d2K7_pZsUlQ_jDBhcQM7tCU1l9XIdA5x4hAaNoyMWHtdfVuko4hPsJws7QGITuTHk5S3lSuO5EBFqkD_QoUvxSrL16yIUrANOZBt3k-wh19Ddgedpu4EpxBbzNUObYeBiNABq1Nv7Ihf_lfGuGTvYSYfothZMxbjIqWo-nACnwu8ww5wiEHnedzjO8W_hLgkWRdQqhTEEUvVB_VTnhe0UkYTPB1Ob7GhGIb52hl8tw7CgiNEeuznSvmT3kxwwX11JoAlcBusTabEA",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bBxZeDufxXKxdlEvYnMSa7mNeJKZvjtDsu5ZobAfUAluIKehNx0OQP-0tfUOW_oUB1N2zNsNEZ_07GS4dinkjm9zUSdsl-zW3nQgiZPP1f5nZAVNrq9gmepsC11Y8TUTzCTt-R-_5NRHO51uPkq_jG",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:06:18.087  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 14:06:18.103  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 140.1507ms 302 
2017-09-01 14:06:18.108  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4b7EPzHkJO3Lj58dkc-6Xsfu5Ng9aRaPcj_GJ1ifVhlAMVixbL89X7WhR42q3nQ30QIrGOSfk2-j8ujPQgcILEWrFs1HL4Fl7bisJGMPqrcqUG4EAJ5bUvWFkXQI9R4Cpt5txFj9v-TGCFANoz3QtUIkTbQnaFImuDWaZHspuQNmFMkNR7G6wqeGJltGOvTVUTnxY0d_v95iyjG6N1wzrhO-XMTdopbV-LdgOK8WexEn4AvSGRUn_OEu0ZQV0UTHK1z0NEY939JE68NMHFTIFJj3-OE2B-F6mCQmu0Zo6jsY1yl4tOBcRLek7fNf4pOxoBp5DdB7ueQmkCEArn7mjF0np6_MvcQllfrKQzdd4jtdSbXBXWDdwYBYFy4Qn8sCXkKrKLEhkoTWevy2ZKiE0Uf3gPUxZt9hKhyAp-tLfNhwryig9w-hZvTbTB9I3K00bhCyEMJUZJ0JYDvEA8GMiEXljmujPOWFB8U1A65V_M1mNXNBpt9GYE-kCFmnB3z4M-0WK50WlBsAI66CAHuRorLIYa7oz1XRMrfFZXAymPF1T_QcdDeEWD_O6hnbGaooNCe0fiYLW002HcDqO2YejLh5W49ZXl_r3YNXqB65JAem58SPu7-LPHhfXzMfv6wCi5pI2ZICbZzF4M0EQeREpqRT4Z8O3_HAD0eJdpfXL2eTroIaMhI8wuttO57Br_NKNqPnYPe6TYGS5dv_14d2KWOYOJFqt_0mzW-4oL-Y7PK9em_tOUzNxGEodayrT7FTarMYQAdOuYmo_VpJH18hFkkeKJUYi-jqrPjXtkSpryUOA  
2017-09-01 14:06:18.111  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.114  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.122  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4b7EPzHkJO3Lj58dkc-6Xsfu5Ng9aRaPcj_GJ1ifVhlAMVixbL89X7WhR42q3nQ30QIrGOSfk2-j8ujPQgcILEWrFs1HL4Fl7bisJGMPqrcqUG4EAJ5bUvWFkXQI9R4Cpt5txFj9v-TGCFANoz3QtUIkTbQnaFImuDWaZHspuQNmFMkNR7G6wqeGJltGOvTVUTnxY0d_v95iyjG6N1wzrhO-XMTdopbV-LdgOK8WexEn4AvSGRUn_OEu0ZQV0UTHK1z0NEY939JE68NMHFTIFJj3-OE2B-F6mCQmu0Zo6jsY1yl4tOBcRLek7fNf4pOxoBp5DdB7ueQmkCEArn7mjF0np6_MvcQllfrKQzdd4jtdSbXBXWDdwYBYFy4Qn8sCXkKrKLEhkoTWevy2ZKiE0Uf3gPUxZt9hKhyAp-tLfNhwryig9w-hZvTbTB9I3K00bhCyEMJUZJ0JYDvEA8GMiEXljmujPOWFB8U1A65V_M1mNXNBpt9GYE-kCFmnB3z4M-0WK50WlBsAI66CAHuRorLIYa7oz1XRMrfFZXAymPF1T_QcdDeEWD_O6hnbGaooNCe0fiYLW002HcDqO2YejLh5W49ZXl_r3YNXqB65JAem58SPu7-LPHhfXzMfv6wCi5pI2ZICbZzF4M0EQeREpqRT4Z8O3_HAD0eJdpfXL2eTroIaMhI8wuttO57Br_NKNqPnYPe6TYGS5dv_14d2KWOYOJFqt_0mzW-4oL-Y7PK9em_tOUzNxGEodayrT7FTarMYQAdOuYmo_VpJH18hFkkeKJUYi-jqrPjXtkSpryUOA) - ModelState is Valid
2017-09-01 14:06:18.131  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.147  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.149  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.161  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.164  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.168  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:18.173  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:06:18.179  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:06:18.323  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:06:18.333  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 211.0558ms
2017-09-01 14:06:18.337  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 229.7805ms 200 text/html; charset=utf-8
2017-09-01 14:06:18.361  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4b_LwOTjN4JGPX7vK5N-ROmPQzXX3ZpI55VOpA-OHVBl3805wzTCLfXTJ03qs2gvRGZfxSq-UkW6UcMgwtg3OAN5X9KnsxWxlcPpJ5wJmhm0hotF4yFP53lU5svWwJgX7L69S4BI34w0jsluuUGQVGPzso-fGyKdCqUKYz5pJF5kZCJO9jP7Cu7a4pGRF0axHibbYwydY3nro_-jH4HDh0DfPFasAWBFccolTcSsP-RxpZhezyYCqGC28NEaeXmYw5w837oAmlHrCvw5MFk9Cngqq9j5Io-LmAei7LrlHoIrA  
2017-09-01 14:06:18.366  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:06:18.372  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:06:18.377  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:06:18.385  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:06:18.402  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:06:18.406  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:06:18.409  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:06:18.412  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:06:18.446  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 85.0738ms 200 text/html; charset=UTF-8
2017-09-01 14:08:13.738  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 14:08:13.742  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 14:08:13.748  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 14:08:13.752  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 14:08:13.759  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 14:08:13.791  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 14:08:13.813  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 75.5126ms 200 application/json
2017-09-01 14:08:13.857  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 14:08:13.862  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 14:08:13.874  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 17.8151ms 200 image/x-icon
2017-09-01 14:08:23.137  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:08:23.141  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 14:08:23.144  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:08:23.147  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 14:08:23.150  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 14:08:23.152  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 14:08:23.157  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:08:23.162  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:08:23.166  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.169  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.172  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:08:23.175  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.178  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.182  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:23.187  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:23.192  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:23.195  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:23.199  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:08:23.202  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4",
  "Nonce": "636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:08:23.206  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 14:08:23.210  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 72.9381ms 302 
2017-09-01 14:08:23.215  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:08:23.219  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:08:23.223  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:08:23.226  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:08:23.229  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.231  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.234  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:08:23.237  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.240  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:23.244  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:23.247  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:23.251  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:23.254  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:23.257  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:08:23.260  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:08:23.263  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 14:08:23.269  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 48.9234ms
2017-09-01 14:08:23.274  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 59.7537ms 200 text/html; charset=utf-8
2017-09-01 14:08:23.290  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/simple-line-icons/simple-line-icons.min.css  
2017-09-01 14:08:23.298  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/simple-line-icons/simple-line-icons.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\simple-line-icons\simple-line-icons.min.css'
2017-09-01 14:08:23.298  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/font-awesome/css/font-awesome.css  
2017-09-01 14:08:23.301  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/uniform/css/uniform.default.min.css  
2017-09-01 14:08:23.301  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap/dist/css/bootstrap.min.css  
2017-09-01 14:08:23.301  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/css/select2.min.css  
2017-09-01 14:08:23.302  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-switch/css/bootstrap-switch.min.css  
2017-09-01 14:08:23.302  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 12.0949ms 200 text/css
2017-09-01 14:08:23.308  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/font-awesome/css/font-awesome.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\font-awesome\css\font-awesome.css'
2017-09-01 14:08:23.309  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/uniform/css/uniform.default.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\uniform\css\uniform.default.min.css'
2017-09-01 14:08:23.312  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap\dist\css\bootstrap.min.css'
2017-09-01 14:08:23.314  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/css/select2.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\css\select2.min.css'
2017-09-01 14:08:23.318  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-switch/css/bootstrap-switch.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-switch\css\bootstrap-switch.min.css'
2017-09-01 14:08:23.319  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/css/select2-bootstrap.min.css  
2017-09-01 14:08:23.322  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 23.2748ms 200 text/css
2017-09-01 14:08:23.328  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 27.5825ms 200 text/css
2017-09-01 14:08:23.336  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 34.7459ms 200 text/css
2017-09-01 14:08:23.340  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 38.4192ms 200 text/css
2017-09-01 14:08:23.341  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 40.0572ms 200 text/css
2017-09-01 14:08:23.348  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/css/select2-bootstrap.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\css\select2-bootstrap.min.css'
2017-09-01 14:08:23.351  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/css/components.min.css  
2017-09-01 14:08:23.354  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/css/plugins.min.css  
2017-09-01 14:08:23.363  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/pages/css/login-5.min.css  
2017-09-01 14:08:23.364  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery/dist/jquery.min.js  
2017-09-01 14:08:23.366  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap/dist/js/bootstrap.min.js  
2017-09-01 14:08:23.368  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 48.8041ms 200 text/css
2017-09-01 14:08:23.371  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/css/components.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\css\components.min.css'
2017-09-01 14:08:23.374  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/css/plugins.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\css\plugins.min.css'
2017-09-01 14:08:23.381  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/pages/css/login-5.min.css'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\pages\css\login-5.min.css'
2017-09-01 14:08:23.382  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery/dist/jquery.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery\dist\jquery.min.js'
2017-09-01 14:08:23.384  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap\dist\js\bootstrap.min.js'
2017-09-01 14:08:23.386  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/js.cookie.min.js  
2017-09-01 14:08:23.391  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 37.8987ms 200 text/css
2017-09-01 14:08:23.394  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 42.7128ms 200 text/css
2017-09-01 14:08:23.400  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 37.6123ms 200 text/css
2017-09-01 14:08:23.409  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 42.4363ms 200 application/javascript
2017-09-01 14:08:23.410  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 46.0102ms 200 application/javascript
2017-09-01 14:08:23.414  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/js.cookie.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\js.cookie.min.js'
2017-09-01 14:08:23.416  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-slimscroll/jquery.slimscroll.min.js  
2017-09-01 14:08:23.434  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js  
2017-09-01 14:08:23.438  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery.blockui.min.js  
2017-09-01 14:08:23.441  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/uniform/jquery.uniform.min.js  
2017-09-01 14:08:23.443  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 57.4797ms 200 application/javascript
2017-09-01 14:08:23.446  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-slimscroll/jquery.slimscroll.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-slimscroll\jquery.slimscroll.min.js'
2017-09-01 14:08:23.463  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/bootstrap-switch/js/bootstrap-switch.min.js  
2017-09-01 14:08:23.464  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-hover-dropdown\bootstrap-hover-dropdown.min.js'
2017-09-01 14:08:23.464  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery.blockui.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery.blockui.min.js'
2017-09-01 14:08:23.468  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/uniform/jquery.uniform.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\uniform\jquery.uniform.min.js'
2017-09-01 14:08:23.473  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-validation/dist/jquery.validate.min.js  
2017-09-01 14:08:23.475  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 59.0433ms 200 application/javascript
2017-09-01 14:08:23.486  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/bootstrap-switch/js/bootstrap-switch.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\bootstrap-switch\js\bootstrap-switch.min.js'
2017-09-01 14:08:23.489  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 55.1452ms 200 application/javascript
2017-09-01 14:08:23.492  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 53.9928ms 200 application/javascript
2017-09-01 14:08:23.498  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 57.0528ms 200 application/javascript
2017-09-01 14:08:23.504  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-validation/dist/jquery.validate.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-validation\dist\jquery.validate.min.js'
2017-09-01 14:08:23.510  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/jquery-validation/dist/additional-methods.min.js  
2017-09-01 14:08:23.518  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 54.3276ms 200 application/javascript
2017-09-01 14:08:23.521  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/select2/js/select2.full.min.js  
2017-09-01 14:08:23.527  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/backstretch/jquery.backstretch.min.js  
2017-09-01 14:08:23.529  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/js/app.min.js  
2017-09-01 14:08:23.533  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 59.9743ms 200 application/javascript
2017-09-01 14:08:23.534  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/jquery-validation/dist/additional-methods.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\jquery-validation\dist\additional-methods.min.js'
2017-09-01 14:08:23.553  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/pages/js/login-5.min.js  
2017-09-01 14:08:23.559  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/select2/js/select2.full.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\select2\js\select2.full.min.js'
2017-09-01 14:08:23.566  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/backstretch/jquery.backstretch.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\backstretch\jquery.backstretch.min.js'
2017-09-01 14:08:23.578  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/js/app.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\js\app.min.js'
2017-09-01 14:08:23.580  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/simple-line-icons/fonts/Simple-Line-Icons.woff  
2017-09-01 14:08:23.582  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 71.959ms 200 application/javascript
2017-09-01 14:08:23.589  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/pages/js/login-5.min.js'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\pages\js\login-5.min.js'
2017-09-01 14:08:23.596  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 73.773ms 200 application/javascript
2017-09-01 14:08:23.598  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 70.8194ms 200 application/javascript
2017-09-01 14:08:23.600  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 70.7569ms 200 application/javascript
2017-09-01 14:08:23.606  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/simple-line-icons/fonts/Simple-Line-Icons.woff'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\simple-line-icons\fonts\Simple-Line-Icons.woff'
2017-09-01 14:08:23.611  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg1.jpg  
2017-09-01 14:08:23.626  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 72.3451ms 200 application/javascript
2017-09-01 14:08:23.639  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 59.0083ms 200 application/font-woff
2017-09-01 14:08:23.643  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg1.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg1.jpg'
2017-09-01 14:08:23.664  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 53.7721ms 200 image/jpeg
2017-09-01 14:08:23.679  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/lib/uniform/images/sprite.png  
2017-09-01 14:08:23.683  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/lib/uniform/images/sprite.png'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\lib\uniform\images\sprite.png'
2017-09-01 14:08:23.689  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg2.jpg  
2017-09-01 14:08:23.689  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/images/login/login/bg3.jpg  
2017-09-01 14:08:23.691  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 12.7941ms 200 image/png
2017-09-01 14:08:23.695  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg2.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg2.jpg'
2017-09-01 14:08:23.699  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/images/login/login/bg3.jpg'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\images\login\login\bg3.jpg'
2017-09-01 14:08:23.715  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 25.4205ms 200 image/jpeg
2017-09-01 14:08:23.749  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 59.5436ms 200 image/jpeg
2017-09-01 14:08:23.875  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/favicon.ico  
2017-09-01 14:08:23.880  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 5.0197ms 404 
2017-09-01 14:08:28.442  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 14:08:28.447  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 14:08:28.455  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 14:08:28.458  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:08:28.461  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:08:28.464  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 14:08:28.470  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:08:28.473  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 26.6687ms
2017-09-01 14:08:28.476  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 33.2276ms 302 
2017-09-01 14:08:28.482  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:08:28.486  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.489  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.492  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:08:28.494  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:08:28.497  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:08:28.503  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:08:28.506  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.508  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:08:28.510  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:08:28.518  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (4ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:08:28.521  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:28.524  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:28.526  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:08:28.529  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:28.532  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:08:28.538  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:28.541  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:28.544  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:08:28.548  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:08:28.552  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.555  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:08:28.558  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4",
  "Nonce": "636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh",
  "SessionId": "c918175a5314367f95879285a1941ced",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:08:28.569  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 14:08:28.572  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 14:08:28.575  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 14:08:28.577  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 14:08:28.583  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZTz1fm0UwH7bqcgWoX2RpYn8voeljW2PStMstN38aLkH1kLjDhUbp3dCu6xov2tl-aRtP5NRQLbnSLydGrr7qFudia9tnH1D69ONh-1zKqF3UG0ZzYrIT3p1TfG0FEJyI15Vc7reROmueVxfRbEN3-xYK4PsflA5X4CCB_uk3iQm11jWClDeQH-w7AnAv3r9G5X45_q2GkfBHt2KCBgfV5byOichzNmnTZTzPoYl0PvVs9kUGkM1q0HuWabIvBMDDU-lhHXtdLa8jzY5xXz18eSk4IyIF2bheNVc7ONacxTp-mlpQ_JbzeSgo6R5hU8s4",
  "Scope": "openid"
}
2017-09-01 14:08:28.587  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.592  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:08:28.595  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:08:28.600  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:08:28.603  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 122.4482ms 200 text/html; charset=UTF-8
2017-09-01 14:11:40.787  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 14:11:40.793  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 14:11:40.818  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 14:11:41.209  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYxMDgsImV4cCI6MTUwNDI0NjQwOCwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDI5MDMxMjU5ODQ4LlpEY3daRGs1TldRdE5EZzBNaTAwWm1NeExUZ3lNalV0TnpWa1pHTTRaRFJoTkRGaU9UYzJZemxqTm1VdFptRXlOeTAwTnpCbUxUbGtaak10WldJMk5qa3dPR0U1WWpaaCIsImlhdCI6MTUwNDI0NjEwOCwic2lkIjoiYzkxODE3NWE1MzE0MzY3Zjk1ODc5Mjg1YTE5NDFjZWQiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYxMDgsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.cXfbH1degCZjafYP9IN3wRwatw2Y2Q0kViKznY9s70XqaD7imtFZIkB8AGslOb911RYEIPOzPHt1648WSQ42WON1SegZgqbEv-Bo_EMRj3DYlTt8uWFW_JM1cRLcP9dwB_rdlvLM7X1H0EiVQH4m76IFPVOnfMnyImLNbrhrTUN_ATnrx00v_uMqYhjKSo13SuBfU4IyVXo4U5P6KsPLlcsKmrTQmcVvGy51ENcSfutbUmkpy8NnNrpGxpOgrc-LapqWdvdq9_6GEC9kYYfF0wpiPe1oL5quONML0hws_q2gFm-CJN9UCe8Xd9O3WWU5Upqhm_FXXbTOtvqhOT94Hw&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aXsgPxWz4ZVujYeXqtnY1okiJ57FKOHgkXycAE8FhjVRV-1ZRxkcg3bE6yh-MiTzPvZYTXMS554ProkNMSVTkWRV5M8TqPHQmeza_wG4ItY5RoJQrk_uZs6QV2bvv0WJcnZ8R_uwSEqCaamI5Dl4-2&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:11:41.240  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.255  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.261  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 14:11:41.268  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:11:41.272  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 14:11:41.288  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.292  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 14:11:41.302  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 14:11:41.310  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 14:11:41.501  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (34ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:41.543  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 14:11:41.566  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 14:11:41.580  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504246108,
    "exp": 1504246408,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398429031259848.ZDcwZDk5NWQtNDg0Mi00ZmMxLTgyMjUtNzVkZGM4ZDRhNDFiOTc2YzljNmUtZmEyNy00NzBmLTlkZjMtZWI2NjkwOGE5YjZh",
    "iat": 1504246108,
    "sid": "c918175a5314367f95879285a1941ced",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504246108,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 14:11:41.584  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.594  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.600  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:11:41.603  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:11:41.606  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:41.609  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:11:41.611  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:11:41.620  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aXsgPxWz4ZVujYeXqtnY1okiJ57FKOHgkXycAE8FhjVRV-1ZRxkcg3bE6yh-MiTzPvZYTXMS554ProkNMSVTkWRV5M8TqPHQmeza_wG4ItY5RoJQrk_uZs6QV2bvv0WJcnZ8R_uwSEqCaamI5Dl4-2",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYxMDgsImV4cCI6MTUwNDI0NjQwOCwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDI5MDMxMjU5ODQ4LlpEY3daRGs1TldRdE5EZzBNaTAwWm1NeExUZ3lNalV0TnpWa1pHTTRaRFJoTkRGaU9UYzJZemxqTm1VdFptRXlOeTAwTnpCbUxUbGtaak10WldJMk5qa3dPR0U1WWpaaCIsImlhdCI6MTUwNDI0NjEwOCwic2lkIjoiYzkxODE3NWE1MzE0MzY3Zjk1ODc5Mjg1YTE5NDFjZWQiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYxMDgsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.cXfbH1degCZjafYP9IN3wRwatw2Y2Q0kViKznY9s70XqaD7imtFZIkB8AGslOb911RYEIPOzPHt1648WSQ42WON1SegZgqbEv-Bo_EMRj3DYlTt8uWFW_JM1cRLcP9dwB_rdlvLM7X1H0EiVQH4m76IFPVOnfMnyImLNbrhrTUN_ATnrx00v_uMqYhjKSo13SuBfU4IyVXo4U5P6KsPLlcsKmrTQmcVvGy51ENcSfutbUmkpy8NnNrpGxpOgrc-LapqWdvdq9_6GEC9kYYfF0wpiPe1oL5quONML0hws_q2gFm-CJN9UCe8Xd9O3WWU5Upqhm_FXXbTOtvqhOT94Hw",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aXsgPxWz4ZVujYeXqtnY1okiJ57FKOHgkXycAE8FhjVRV-1ZRxkcg3bE6yh-MiTzPvZYTXMS554ProkNMSVTkWRV5M8TqPHQmeza_wG4ItY5RoJQrk_uZs6QV2bvv0WJcnZ8R_uwSEqCaamI5Dl4-2",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:11:41.624  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 14:11:41.648  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 451.3963ms 302 
2017-09-01 14:11:41.658  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4aCBcqiP-b4C9tEZCXDl4I4VLMj1P3S3Mpb0trK8wdM1AWzQn-sWky0LVKuu-GGVXUwko0vN0U7N8vxIWIn55r-My5XUXljL8sRRVeEPkBLqIKh4o3gktYEtS8bhTCBxrk0rur9HMJden4mMzfXhDSJIKKh_BGYz9IurWWCkN39v7RpgcmytymD2kte_4HYbjISMWkHissPBTflHGOLUrElF2ZIu5KSA1D8vC3Vmocr7wIpxNq0a3xQPNCLWoYstNdHZ1i3sNNU_I6UvZWxZUMQGl5BZZXHNkqKg6OzetU0jafz6R8J6WLO1r47KhGfsN7hSCUqqKR4GLSDp6zS9fIowcKulLbl2mePNaSpNSFD9r2uv7lHkNp31uNeQQLeWL9hi_6jaMD1OHVxL7lkK6LvLvZ8jZ_ugZYpyc8WqKUmyIX6MzRDiHfZsGo6bZGGrdQ2PjcS7xN6tRoyHqKvVZcBz8MkfwgN7JxiMJxxNtzr-uxOUbKEQYtu4hVB0EIJ4zYTPo17rG_WCBLARdgkDF6rE8OMNW5rTwtkVrqTfV2OkLZ4R8tgDJsAufmImJ2GFg6Ru70I0K4LgPuHM0Xw-XN9uWVIMKoSHuuP487dpxasZSFjQyvGMl_4vvzZS066QHLjah13_FLzzi6cWtoHIJgQL3zyXaw4CFIAOSfXaKk6mvSM5ejjyHTu7oCzhSgxMHj8BRamgcRGMD8YFz4NaxuZXgtcSdxKQT_PEgXNtQp2LzhJHMKk_H3pUJpyphwDxvjY4xZ5fbH2Qwc8qpLnjRKSPRXvNAL8yu76iYikGac5EA  
2017-09-01 14:11:41.664  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.669  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.815  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4aCBcqiP-b4C9tEZCXDl4I4VLMj1P3S3Mpb0trK8wdM1AWzQn-sWky0LVKuu-GGVXUwko0vN0U7N8vxIWIn55r-My5XUXljL8sRRVeEPkBLqIKh4o3gktYEtS8bhTCBxrk0rur9HMJden4mMzfXhDSJIKKh_BGYz9IurWWCkN39v7RpgcmytymD2kte_4HYbjISMWkHissPBTflHGOLUrElF2ZIu5KSA1D8vC3Vmocr7wIpxNq0a3xQPNCLWoYstNdHZ1i3sNNU_I6UvZWxZUMQGl5BZZXHNkqKg6OzetU0jafz6R8J6WLO1r47KhGfsN7hSCUqqKR4GLSDp6zS9fIowcKulLbl2mePNaSpNSFD9r2uv7lHkNp31uNeQQLeWL9hi_6jaMD1OHVxL7lkK6LvLvZ8jZ_ugZYpyc8WqKUmyIX6MzRDiHfZsGo6bZGGrdQ2PjcS7xN6tRoyHqKvVZcBz8MkfwgN7JxiMJxxNtzr-uxOUbKEQYtu4hVB0EIJ4zYTPo17rG_WCBLARdgkDF6rE8OMNW5rTwtkVrqTfV2OkLZ4R8tgDJsAufmImJ2GFg6Ru70I0K4LgPuHM0Xw-XN9uWVIMKoSHuuP487dpxasZSFjQyvGMl_4vvzZS066QHLjah13_FLzzi6cWtoHIJgQL3zyXaw4CFIAOSfXaKk6mvSM5ejjyHTu7oCzhSgxMHj8BRamgcRGMD8YFz4NaxuZXgtcSdxKQT_PEgXNtQp2LzhJHMKk_H3pUJpyphwDxvjY4xZ5fbH2Qwc8qpLnjRKSPRXvNAL8yu76iYikGac5EA) - ModelState is Valid
2017-09-01 14:11:41.825  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.844  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.847  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.862  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.865  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.875  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:41.882  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:41.894  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:11:44.084  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:11:44.625  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 2852.7284ms
2017-09-01 14:11:44.637  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2978.4785ms 200 text/html; charset=utf-8
2017-09-01 14:11:44.656  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4Z3hmUp5hTViN9SaCtztaLeu5Xgy8cCCnOSW_VI-Mh-l9b89cEvKqOxVC31a2hxAtYNMcqOaFJ8mvUk2TExEiCw0r9ligqCVFAvEvcZKDt5R30xZwgaxerNSwHbB-Cpz_5MKZ9gsGb7Uersrp8NxU8cS6u0Lwhpqj1TtqVsfioDl7AVgtuUhTJfXjIoqClB3VMEBvHn6Kzq1QShMCpRXHruGD0AQq_ZfX9lWYATnEit-yMrweFloNqGk6f74ucHdPu1CAVSL8JdOwJa2GN3ZYObwg-2ikmerb5WF83GlsgtbQ  
2017-09-01 14:11:44.660  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:11:44.663  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:11:44.668  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:11:44.675  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:11:44.694  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:44.700  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:11:44.704  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:11:44.709  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:11:44.742  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 86.3564ms 200 text/html; charset=UTF-8
2017-09-01 14:11:47.467  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:11:47.471  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 14:11:47.477  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:11:47.480  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 14:11:47.491  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 14:11:47.502  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 14:11:47.509  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:47.520  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:47.524  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.527  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.530  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:47.533  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.536  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.573  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:47.591  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:47.618  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:47.621  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:47.634  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:47.649  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
  "Nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:11:47.660  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 14:11:47.666  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 199.4086ms 302 
2017-09-01 14:11:47.672  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:11:47.682  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:11:47.701  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:47.707  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:47.710  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.714  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.718  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:47.721  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.723  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:47.726  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:47.730  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:47.734  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:47.737  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:47.740  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:47.746  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:48.091  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 14:11:48.125  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 444.2925ms
2017-09-01 14:11:48.128  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 456.4821ms 200 text/html; charset=utf-8
2017-09-01 14:11:49.334  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 14:11:49.375  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 14:11:49.399  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (5ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 14:11:49.425  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:11:49.434  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:11:49.438  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 14:11:49.442  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:11:49.448  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 95.3772ms
2017-09-01 14:11:49.452  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 118.1527ms 302 
2017-09-01 14:11:49.457  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:11:49.461  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.464  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.467  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:11:49.471  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:11:49.474  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:11:49.484  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:11:49.487  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.493  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:11:49.497  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:49.503  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:49.506  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.508  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.511  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:49.515  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.518  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.521  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:49.525  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:49.528  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:49.533  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:49.536  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.538  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:49.541  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
  "Nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
  "SessionId": "4c3b165df84990393e2827add8c937a0",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:11:49.557  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:11:49.559  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 14:11:49.563  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 105.9567ms 302 
2017-09-01 14:11:49.569  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:11:49.572  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.575  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.585  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:11:49.591  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.594  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:49.600  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:49.603  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.606  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.609  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:49.612  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.615  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:49.620  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:49.624  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:49.627  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:49.631  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:49.635  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:49.637  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:49.641  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:49.645  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:49.649  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:50.062  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 14:11:50.368  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 784.4103ms
2017-09-01 14:11:50.372  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 803.068ms 200 text/html; charset=utf-8
2017-09-01 14:11:51.963  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 14:11:51.969  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:51.972  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:51.990  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 14:11:52.002  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.005  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:52.009  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:52.013  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.018  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.021  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:52.023  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.026  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.031  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:52.035  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:52.039  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:52.042  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:52.049  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.052  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:52.057  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.072  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:11:52.074  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 91.3575ms
2017-09-01 14:11:52.078  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 115.5609ms 302 
2017-09-01 14:11:52.084  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3&state=CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:11:52.087  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.090  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.093  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:11:52.097  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:11:52.099  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:11:52.102  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:11:52.105  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.110  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:11:52.113  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:11:52.117  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:11:52.121  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.124  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.127  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:11:52.130  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.132  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:11:52.135  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:52.138  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:52.142  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:11:52.146  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:11:52.150  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.152  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:11:52.155  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
  "Nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
  "SessionId": "4c3b165df84990393e2827add8c937a0",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:11:52.158  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:11:52.166  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 14:11:52.170  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 14:11:52.195  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 14:11:52.209  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 14:11:52.216  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 14:11:52.222  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 14:11:52.262  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4ZDnAkabj6fWVeSug-ZQ8qaT5vbJKhBcBRnbl4RXbEPbYoWN1lmHKvmVwbXnJeJ1Yd-6oLUuTKN6PhkP05L4UBa-c5gxcegubo68ct_IJAP8bti4vDGyLvv5uRilwmwjIfiptODnQ_gjonBrPmeLiYWXnkLeJiG4VfCzY7AQb-Ub-UF-0BJYuARImRR8a2keLV3OeMoJqhxKsj64yFYXRZgfXFDjs36tDfQBKIWKaZsKgAS9nVcp_klvbd3kfyDM1d0dLPCbQ8oxLiRSbYyAiWpOT4i6w2nN_1kDQRJMEbc1EUT_0qlfO4ne8PQ-z7KTyc",
  "Scope": "openid"
}
2017-09-01 14:11:52.273  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.282  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:11:52.285  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:11:52.288  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:11:52.297  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 213.1707ms 200 text/html; charset=UTF-8
2017-09-01 14:12:25.312  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 14:12:25.325  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 14:12:25.361  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 14:12:25.799  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYzMTIsImV4cCI6MTUwNDI0NjYxMiwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDMxMDc0NTQ3MTI2Lk5qUmhaRGN3WVRNdE9USTRZeTAwWXpjNUxUbGpaVEV0TmpNMVltTXhZMk0xWldabU4yWmlZall6TURFdE5UWXdNQzAwTXpJd0xUbGxNRGN0TldRd01qa3labUUwTXpRMyIsImlhdCI6MTUwNDI0NjMxMiwic2lkIjoiNGMzYjE2NWRmODQ5OTAzOTNlMjgyN2FkZDhjOTM3YTAiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYzMDksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.bee4Te0iK4CGS2Tw6-z4rjBDuU5d59iZ0PrIuKW6k4rahR9Ako9ORi4CmZ76EN-yctldPUMAuW3DkLN6yXuNjBhrBkVFpwL-T7BCoPaogjXz12bP4pVmy14ys5YWTOOM3Zq0E8cuY3bg7QrHke1GLp3LKqLKBT3jUiMeOmPrmQ7lYsjJ9S1FgwPBeUI9AJNphIJfNHhlr5ytjQxuBFMI_uSSRRo1aL7oquDt7Yv91CEGznXW97UXZsVIOV7xAkE4LRVVmyIKjzRS5t2u0QeQC07_HriuUDtKaNfKkI4CTBb7Q2Sc8VZl749CcbfmoFlEEIwvvjEJdkV0U5CPcFlpYQ&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bSXpP6O16H4DiHTEpcVWtJ06RVDFPMbnVOm0QL2bKO5FcfhV1n_GgZ_Ez8CAAUljatTzj7hx98ot1wF5DoTxjwEt4UW7tXp7bxDKtGG2o6XjPQI7rShvckpNp9ZA3YfUES7YTUmUx3jGQWZLZo_7Gl&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:12:25.835  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:25.855  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:25.861  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 14:12:25.868  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:12:25.877  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 14:12:25.896  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:25.906  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 14:12:25.915  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 14:12:25.931  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 14:12:26.258  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (100ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:26.317  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 14:12:26.352  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 14:12:26.368  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504246312,
    "exp": 1504246612,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398431074547126.NjRhZDcwYTMtOTI4Yy00Yzc5LTljZTEtNjM1YmMxY2M1ZWZmN2ZiYjYzMDEtNTYwMC00MzIwLTllMDctNWQwMjkyZmE0MzQ3",
    "iat": 1504246312,
    "sid": "4c3b165df84990393e2827add8c937a0",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504246309,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 14:12:26.376  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.384  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.401  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:12:26.413  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:12:26.415  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:26.419  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:12:26.431  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:12:26.453  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bSXpP6O16H4DiHTEpcVWtJ06RVDFPMbnVOm0QL2bKO5FcfhV1n_GgZ_Ez8CAAUljatTzj7hx98ot1wF5DoTxjwEt4UW7tXp7bxDKtGG2o6XjPQI7rShvckpNp9ZA3YfUES7YTUmUx3jGQWZLZo_7Gl",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYzMTIsImV4cCI6MTUwNDI0NjYxMiwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDMxMDc0NTQ3MTI2Lk5qUmhaRGN3WVRNdE9USTRZeTAwWXpjNUxUbGpaVEV0TmpNMVltTXhZMk0xWldabU4yWmlZall6TURFdE5UWXdNQzAwTXpJd0xUbGxNRGN0TldRd01qa3labUUwTXpRMyIsImlhdCI6MTUwNDI0NjMxMiwic2lkIjoiNGMzYjE2NWRmODQ5OTAzOTNlMjgyN2FkZDhjOTM3YTAiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYzMDksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.bee4Te0iK4CGS2Tw6-z4rjBDuU5d59iZ0PrIuKW6k4rahR9Ako9ORi4CmZ76EN-yctldPUMAuW3DkLN6yXuNjBhrBkVFpwL-T7BCoPaogjXz12bP4pVmy14ys5YWTOOM3Zq0E8cuY3bg7QrHke1GLp3LKqLKBT3jUiMeOmPrmQ7lYsjJ9S1FgwPBeUI9AJNphIJfNHhlr5ytjQxuBFMI_uSSRRo1aL7oquDt7Yv91CEGznXW97UXZsVIOV7xAkE4LRVVmyIKjzRS5t2u0QeQC07_HriuUDtKaNfKkI4CTBb7Q2Sc8VZl749CcbfmoFlEEIwvvjEJdkV0U5CPcFlpYQ",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bSXpP6O16H4DiHTEpcVWtJ06RVDFPMbnVOm0QL2bKO5FcfhV1n_GgZ_Ez8CAAUljatTzj7hx98ot1wF5DoTxjwEt4UW7tXp7bxDKtGG2o6XjPQI7rShvckpNp9ZA3YfUES7YTUmUx3jGQWZLZo_7Gl",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:12:26.455  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 14:12:26.481  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 703.0181ms 302 
2017-09-01 14:12:26.510  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Za5oDRjJ-lmA9ZJp8C69e2K4olFgWNkjoPt7isuAyu_hTz4skvArPl8eOeQMuwCKWUkTonsJ1F7lF-LT9gHrYVaYaIe3owH_WsXyRbwXe4owvlJKc-_A7QNOclSoMOIwyIqJXClNU6xxj-yAlwsk8EpaP5v_C-sco5PyhtS9eszptX1jLkLpLNPi1K-Xs2uG5S9QBkbyes6d31qB3IFslrdeFJ0ne3axyMFylX4YFTVdlR--hD-jGTRUcdqXAhpEXLRgArjcoHbhOUPr2ObR8MW2tAKRyxBX_F0HVctrOynQoByLSximOTgA-D7O7chybHN0_x-kO5IEjNqGNd9jhNlDpVsnckCD6qwBUjAeu_JTU9w-QCcr7DjTvenXgxg6-8-aQoDh4MXPSIPXwT2tuiBYE7XTcmC4Mm2XBuN7LngELSjsNQQS_3VB3kJk1q93eQ_dfFg1dN2rBoeMvlp2pChkXcbjS21HyQZf2WliZR_YaJ-Z18fa8kbAtXie8Xexi7u2K308Q6C84zE5mSnsJ27MSt9RYLqmbi3YFQ_lmuh6oiBeBuUsxd64fqYsfPUcIym_p39VjSByMnyPdesQA8ONntV9kdUhRs-LwNasbanCcd0i0kHttb8vcfS_a1F0QM0SBbdyhtfN5X9JKHw9Yq_Rmp2dZfnfoE4auVka0MPP_hjV3ta5-7D2lIDOJPwy9lC8wlTGce_0hNoe7W58rZfHvsG4d9d0MLqC_uVMn5kycA_7m-tMqTTyx6M0uoBQzSln2VcyZL8fKTAqyAzI5gqx5sk040OQhx18AATx5KZQ  
2017-09-01 14:12:26.521  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.524  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.787  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Za5oDRjJ-lmA9ZJp8C69e2K4olFgWNkjoPt7isuAyu_hTz4skvArPl8eOeQMuwCKWUkTonsJ1F7lF-LT9gHrYVaYaIe3owH_WsXyRbwXe4owvlJKc-_A7QNOclSoMOIwyIqJXClNU6xxj-yAlwsk8EpaP5v_C-sco5PyhtS9eszptX1jLkLpLNPi1K-Xs2uG5S9QBkbyes6d31qB3IFslrdeFJ0ne3axyMFylX4YFTVdlR--hD-jGTRUcdqXAhpEXLRgArjcoHbhOUPr2ObR8MW2tAKRyxBX_F0HVctrOynQoByLSximOTgA-D7O7chybHN0_x-kO5IEjNqGNd9jhNlDpVsnckCD6qwBUjAeu_JTU9w-QCcr7DjTvenXgxg6-8-aQoDh4MXPSIPXwT2tuiBYE7XTcmC4Mm2XBuN7LngELSjsNQQS_3VB3kJk1q93eQ_dfFg1dN2rBoeMvlp2pChkXcbjS21HyQZf2WliZR_YaJ-Z18fa8kbAtXie8Xexi7u2K308Q6C84zE5mSnsJ27MSt9RYLqmbi3YFQ_lmuh6oiBeBuUsxd64fqYsfPUcIym_p39VjSByMnyPdesQA8ONntV9kdUhRs-LwNasbanCcd0i0kHttb8vcfS_a1F0QM0SBbdyhtfN5X9JKHw9Yq_Rmp2dZfnfoE4auVka0MPP_hjV3ta5-7D2lIDOJPwy9lC8wlTGce_0hNoe7W58rZfHvsG4d9d0MLqC_uVMn5kycA_7m-tMqTTyx6M0uoBQzSln2VcyZL8fKTAqyAzI5gqx5sk040OQhx18AATx5KZQ) - ModelState is Valid
2017-09-01 14:12:26.803  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.832  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.850  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.864  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.878  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.894  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:26.914  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:26.925  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:12:29.896  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:12:30.485  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 3782.5498ms
2017-09-01 14:12:30.494  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3984.6002ms 200 text/html; charset=utf-8
2017-09-01 14:12:30.521  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4YlixMlxG-PPbvSm7rsiTexWOB-y16vqiE4JIae_WqzrIMpdb88puSQX0Aaz_t_zzSBPtZBF6pbttuWQgb9KmfOZ6642cuODbZ6621vQuPEGQktJN07VyeWPcGO0DLDOUB9Dtc8QKLJkEgsEfdMPRd24omB-LTVPkn0O9P4axAbvGvMXrpNjXQP2De8IbY0hwBXLhv8Wuxs0Xr-_JMzopZTyKJrXDKZTGwyugFS6wbcBsDjMIABuh9DWENuDn_KbB7N6Hza-br1F2qOeEBzXd_saNVGopIUDT67_00Ne88YAw  
2017-09-01 14:12:30.526  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:12:30.529  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:12:30.536  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:12:30.541  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:12:30.563  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:30.570  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:12:30.574  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:12:30.578  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:12:30.614  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 93.6151ms 200 text/html; charset=UTF-8
2017-09-01 14:12:47.637  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 14:12:47.643  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 14:12:47.667  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 14:12:48.018  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:12:48.061  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 14:12:48.073  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:12:48.076  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 14:12:48.088  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 14:12:48.102  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 14:12:48.110  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:48.308  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (38ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:48.356  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.360  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.363  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:48.365  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.368  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.406  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:48.424  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:48.449  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:48.453  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:48.464  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:48.487  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
  "Nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:12:48.499  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 14:12:48.510  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 504.9824ms 302 
2017-09-01 14:12:48.521  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:12:48.677  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:12:48.694  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:48.702  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:48.705  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.708  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.711  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:48.714  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.718  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:48.722  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:48.727  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:48.732  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:48.737  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:48.739  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:48.747  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:51.339  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 14:12:51.710  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 3072.9356ms
2017-09-01 14:12:51.730  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3207.337ms 200 text/html; charset=utf-8
2017-09-01 14:12:53.684  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 14:12:53.732  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 14:12:53.752  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 14:12:53.779  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:12:53.790  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:12:53.794  IdentitySite.Controllers.AccountController   Debug: 验证ReturnURl：/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0，结果，True
2017-09-01 14:12:53.800  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:12:53.803  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 101.1108ms
2017-09-01 14:12:53.807  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 123.8334ms 302 
2017-09-01 14:12:53.814  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:12:53.821  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.824  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.827  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:12:53.829  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:12:53.833  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:12:53.844  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:12:53.847  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.855  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:12:53.859  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:53.865  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:53.868  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.871  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.874  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:53.876  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.879  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.883  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:53.887  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:53.890  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:53.894  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:53.896  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.899  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:53.901  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
  "Nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
  "SessionId": "b826c4c25ca9fad0ca5f9e39ff618309",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:12:53.919  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:12:53.923  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 14:12:53.927  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 113.1987ms 302 
2017-09-01 14:12:53.931  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:12:53.934  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.938  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.946  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:12:53.953  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.956  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:53.960  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:53.963  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.966  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.970  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:53.973  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.976  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:53.979  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:53.982  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:53.985  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:53.993  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:53.996  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:53.999  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:54.003  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:54.008  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:54.012  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:54.477  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 14:12:54.781  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 836.5827ms
2017-09-01 14:12:54.785  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 853.7881ms 200 text/html; charset=utf-8
2017-09-01 14:12:56.178  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 14:12:56.182  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.187  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.203  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 14:12:56.211  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.213  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:56.220  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:56.223  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.225  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.228  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:56.230  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.232  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.238  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:56.242  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:56.246  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:56.250  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:56.254  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.257  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:56.263  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.279  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:12:56.282  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 86.9013ms
2017-09-01 14:12:56.286  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 108.4394ms 302 
2017-09-01 14:12:56.293  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0&state=CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:12:56.297  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.300  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.306  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:12:56.309  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:12:56.311  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:12:56.314  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:12:56.319  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.327  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:12:56.330  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:12:56.334  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:12:56.339  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.342  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.344  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:12:56.347  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.350  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:12:56.354  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:56.359  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:56.363  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:12:56.366  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:12:56.370  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.372  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:12:56.375  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
  "Nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
  "SessionId": "b826c4c25ca9fad0ca5f9e39ff618309",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:12:56.378  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:12:56.387  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 14:12:56.391  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 14:12:56.414  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 14:12:56.426  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 14:12:56.433  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 14:12:56.438  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 14:12:56.493  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4bI_xuLXeSwJzUap2ddsHxS5Q6WiX4z8rcj8doSDoS6StaNo-5D2zdsIlKxV2P-cxJCUEok26ATZy6ZLOs00007bhkuS03jQE9bbx5bKMgfLnVrXAjK7xHgNsaQRo8oNEPP2iUghHs2nh85lQ7M6lLpJAS5ETZ11AawA71KSEoxYhPN1Jq1OhJR1toPaHv_nnjZcKHtc7lIhYIDKGu2seALyayXuC-3vhIaTIoqeRYcVzb9t7QS8cwcYd2WzqykYAP7at46L1ZsZNWYm37R_hAvOnUCKvpOSs98FEttvys17pdi4nnLWBpTJm-RAawcEF8",
  "Scope": "openid"
}
2017-09-01 14:12:56.511  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.522  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:12:56.524  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:12:56.527  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:12:56.538  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 245.2097ms 200 text/html; charset=UTF-8
2017-09-01 14:23:01.443  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 14:23:01.449  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 14:23:01.476  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 14:23:01.846  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYzNzYsImV4cCI6MTUwNDI0NjY3NiwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDMxNjYzODMwMTA1LlkyTTBNMkl6TVRZdE9Ua3hOeTAwTmpWbUxXSTFaalF0WmpRMk1UZzFOalk0TUdSa1lUZ3pNekkwWlRJdE5tRTJNeTAwWVRSbExXSTNObVF0T0RJek5tUmpaREF3TTJJMCIsImlhdCI6MTUwNDI0NjM3Niwic2lkIjoiYjgyNmM0YzI1Y2E5ZmFkMGNhNWY5ZTM5ZmY2MTgzMDkiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYzNzMsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.Fb44oEE1TRlwwCtdWVJgDOIJy-zPcbSzbq0tsuvm7kNoocaPj5wzIT73KiZNrnsNSBy-zyjYMdUVOH7_qHsEJYmtdzKUHOeReFR9akQsWjsrJoXfWsQLKuWdX7G6gg8sxKFDBb9rX7s62Bx_AVAXQrJWImTbwpQmzi69pXxKCaupx6dZlPeJV0_RTZMy3R75gS96uGujq4_Rb0T-0XGQRT_PtKHQj0pbGJUW-7GHJAg4f0xcWVE0WvytyXn13zTOhPouVao_v1ZAW7FixWyNQSxua05HFfq9acsqlC_OW4kPX6WLlzdGUiO1qiXLEahxF3AUalZXLZY4W1ombV-u3A&state=CfDJ8ECGCikUVX1HsEI_-gAmK4Zy42o97FefWjP8eHHz486Gc_W_2IZyHdEzCzTAFv7keI495xw6ny5y0ipm2cVRg1f5BImwU7lReOhXQJPUWcwCmbWSXUaVymOZKch-zshZdAzyH-xQz2MfKPZIawQUfhBk01dl1XXS3HDjEn8P1u8A&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:23:01.882  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:01.899  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:01.905  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 14:23:01.914  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:23:01.917  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 14:23:01.936  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:01.941  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 14:23:01.950  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 14:23:01.962  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 14:23:02.225  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (41ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:02.271  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 14:23:02.295  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 14:23:02.310  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504246376,
    "exp": 1504246676,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398431663830105.Y2M0M2IzMTYtOTkxNy00NjVmLWI1ZjQtZjQ2MTg1NjY4MGRkYTgzMzI0ZTItNmE2My00YTRlLWI3NmQtODIzNmRjZDAwM2I0",
    "iat": 1504246376,
    "sid": "b826c4c25ca9fad0ca5f9e39ff618309",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504246373,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 14:23:02.314  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.325  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.333  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:23:02.335  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:23:02.339  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:02.342  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:23:02.346  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 14:23:02.357  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4Zy42o97FefWjP8eHHz486Gc_W_2IZyHdEzCzTAFv7keI495xw6ny5y0ipm2cVRg1f5BImwU7lReOhXQJPUWcwCmbWSXUaVymOZKch-zshZdAzyH-xQz2MfKPZIawQUfhBk01dl1XXS3HDjEn8P1u8A",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDYzNzYsImV4cCI6MTUwNDI0NjY3NiwiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDMxNjYzODMwMTA1LlkyTTBNMkl6TVRZdE9Ua3hOeTAwTmpWbUxXSTFaalF0WmpRMk1UZzFOalk0TUdSa1lUZ3pNekkwWlRJdE5tRTJNeTAwWVRSbExXSTNObVF0T0RJek5tUmpaREF3TTJJMCIsImlhdCI6MTUwNDI0NjM3Niwic2lkIjoiYjgyNmM0YzI1Y2E5ZmFkMGNhNWY5ZTM5ZmY2MTgzMDkiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDYzNzMsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.Fb44oEE1TRlwwCtdWVJgDOIJy-zPcbSzbq0tsuvm7kNoocaPj5wzIT73KiZNrnsNSBy-zyjYMdUVOH7_qHsEJYmtdzKUHOeReFR9akQsWjsrJoXfWsQLKuWdX7G6gg8sxKFDBb9rX7s62Bx_AVAXQrJWImTbwpQmzi69pXxKCaupx6dZlPeJV0_RTZMy3R75gS96uGujq4_Rb0T-0XGQRT_PtKHQj0pbGJUW-7GHJAg4f0xcWVE0WvytyXn13zTOhPouVao_v1ZAW7FixWyNQSxua05HFfq9acsqlC_OW4kPX6WLlzdGUiO1qiXLEahxF3AUalZXLZY4W1ombV-u3A",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4Zy42o97FefWjP8eHHz486Gc_W_2IZyHdEzCzTAFv7keI495xw6ny5y0ipm2cVRg1f5BImwU7lReOhXQJPUWcwCmbWSXUaVymOZKch-zshZdAzyH-xQz2MfKPZIawQUfhBk01dl1XXS3HDjEn8P1u8A",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:23:02.360  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 14:23:02.386  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 552.655ms 302 
2017-09-01 14:23:02.400  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4Yfb2UvYKYYAbsNnH5_1SjbKi2-5_Kouh4sF5OJZDgTdd79b1A2RS8MFF2dgUh4xgb4nYTftbRhus_0tVR2p30xeDY21wKIPAAPEHoNI1mnme_HPN6lwR5BonBhJV571APKl8_J2zFWdXBpckHnTx4l365R2SYI7NEi1Uk34fVjBiqazSY39NkrEH6-EBiPoGO_flw848gMj_Itw3oFvnexMS0gtm9WYBy3xorSSH5p2D4KtpRBCxcRc5707C6ljgr1OkE2bkA_52w-h-rc2bH9Lcp_X27-ejaxVaary_40QtlCTardWumHbd7Idc29kEYH7ZyP-IT95dKzr7XXuvKZq6Aol9l67HOWE6dyJatLhNww_Z5BSJQ4pcIFyzzPe579ergOO9rWV7VQYNCZfLMDBhpMxXIb832JhWdg62OeYgM331ygpRcIK41rs-WO2SGRNb04-frUY7cFH7sRo03oSD2hi5Ygbrs5zRTLYlF8LDTNZdHc_nxuFH0JcX_4bzizA9Irlib8O57IipxZToJ7pqJrHvP37JUU-sLxknAKK8M6kkxVGjnDt7SFA07GJ_kegWNSH9mjfwKVyxdly6uT9gPrtLnx5iHPRT1ofvCsY5jAkvUdIie2CiCjaul2Xi_9YIIPkG2KSR_S4AlUKq4T48H6LH5rSKKipd0vx3uV3SCoY-RQ7TSM5GpPC0KgBlRSrjN9fc5C8P2E1JFpSWxZYZU2jOhxIM8RvTgjBtgKAZoF4EEsALOXXG3bG8nQZseXhBG2AFF8vNrjY96wYTyDkhQwFF1tH2u81XhlQqEIPg  
2017-09-01 14:23:02.407  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.410  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.574  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4Yfb2UvYKYYAbsNnH5_1SjbKi2-5_Kouh4sF5OJZDgTdd79b1A2RS8MFF2dgUh4xgb4nYTftbRhus_0tVR2p30xeDY21wKIPAAPEHoNI1mnme_HPN6lwR5BonBhJV571APKl8_J2zFWdXBpckHnTx4l365R2SYI7NEi1Uk34fVjBiqazSY39NkrEH6-EBiPoGO_flw848gMj_Itw3oFvnexMS0gtm9WYBy3xorSSH5p2D4KtpRBCxcRc5707C6ljgr1OkE2bkA_52w-h-rc2bH9Lcp_X27-ejaxVaary_40QtlCTardWumHbd7Idc29kEYH7ZyP-IT95dKzr7XXuvKZq6Aol9l67HOWE6dyJatLhNww_Z5BSJQ4pcIFyzzPe579ergOO9rWV7VQYNCZfLMDBhpMxXIb832JhWdg62OeYgM331ygpRcIK41rs-WO2SGRNb04-frUY7cFH7sRo03oSD2hi5Ygbrs5zRTLYlF8LDTNZdHc_nxuFH0JcX_4bzizA9Irlib8O57IipxZToJ7pqJrHvP37JUU-sLxknAKK8M6kkxVGjnDt7SFA07GJ_kegWNSH9mjfwKVyxdly6uT9gPrtLnx5iHPRT1ofvCsY5jAkvUdIie2CiCjaul2Xi_9YIIPkG2KSR_S4AlUKq4T48H6LH5rSKKipd0vx3uV3SCoY-RQ7TSM5GpPC0KgBlRSrjN9fc5C8P2E1JFpSWxZYZU2jOhxIM8RvTgjBtgKAZoF4EEsALOXXG3bG8nQZseXhBG2AFF8vNrjY96wYTyDkhQwFF1tH2u81XhlQqEIPg) - ModelState is Valid
2017-09-01 14:23:02.582  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.599  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.602  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.615  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.618  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.629  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:02.634  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.645  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 14:23:02.712  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 14:23:02.715  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.719  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:02.724  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 14:23:02.729  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 14:23:02.731  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 14:23:02.741  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 14:23:02.783  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 14:23:02.843  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 129.7069ms 200 application/json
2017-09-01 14:23:02.885  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/favicon.ico  
2017-09-01 14:23:02.896  Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware   Information: Sending file. Request path: '/favicon.ico'. Physical path: 'D:\ProjectTest\NetCore\YXL.OpenNetCore\IdentitySite\wwwroot\favicon.ico'
2017-09-01 14:23:02.909  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 23.7107ms 200 image/x-icon
2017-09-01 14:23:05.228  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 14:23:05.836  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 3299.0069ms
2017-09-01 14:23:05.875  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 3475.3094ms 200 text/html; charset=utf-8
2017-09-01 14:23:05.880  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4bgQfKdHCLo0CBKMt_VmVmBZubLl3XH2zJNKV40aZuHhZD8k14XQ5I5zPxFoccOLqemeAa65IWTYp0wCp8Wu1h91j8JS8Q_RXsPIZo-hcVGU_sflSkvvTVzbcYrzaSbK7sAAY3WTlphs45G-jNxrPrqHBWTav9C7Y8e6UqJkoSEin2Y89v3eQNXt02oDK5urlX3C3YpWdwuCufxogD47WGfAdzgjuQVpdW-RpkSe5P5tQDXVCmATdqHP3QJ9-U5De6zJRGLdsN0XV2cz9bv31DXxufMhE8PNo43nu4EVHODmQ  
2017-09-01 14:23:05.888  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 14:23:05.896  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 14:23:05.912  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 14:23:05.923  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 14:23:05.956  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (11ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:05.963  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 14:23:05.972  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 14:23:05.980  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 14:23:06.027  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 146.6156ms 200 text/html; charset=UTF-8
2017-09-01 14:23:10.960  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:23:10.967  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 14:23:10.975  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:23:10.980  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 14:23:10.997  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 14:23:11.006  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 14:23:11.016  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:11.027  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:11.035  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.038  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.040  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:11.043  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.046  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.088  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:11.099  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:11.110  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:11.114  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:11.125  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:11.141  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
  "Nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:23:11.152  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 14:23:11.159  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 199.839ms 302 
2017-09-01 14:23:11.165  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:23:11.187  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:23:11.213  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:11.222  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:11.224  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.228  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.231  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:11.235  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.237  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:11.241  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:11.246  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:11.250  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:11.253  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:11.256  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:11.262  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:11.622  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 14:23:11.654  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 475.3379ms
2017-09-01 14:23:11.658  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 492.6005ms 200 text/html; charset=utf-8
2017-09-01 14:23:17.907  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 14:23:17.943  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 14:23:17.962  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 14:23:17.989  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:23:17.998  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:23:18.003  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:23:18.006  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 83.323ms
2017-09-01 14:23:18.009  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 102.6064ms 302 
2017-09-01 14:23:18.015  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:23:18.020  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.022  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.025  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:23:18.029  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:23:18.032  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:23:18.041  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:23:18.045  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.053  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:23:18.056  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:18.064  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:18.066  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.070  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.073  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:18.076  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.078  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.083  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:18.088  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:18.095  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:18.099  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:18.102  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.105  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:18.108  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
  "Nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
  "SessionId": "6bd2b2de804b5afa3f9ae6a1dda2e9c9",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:23:18.125  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:23:18.127  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing consent: User has not yet consented
2017-09-01 14:23:18.131  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 115.9066ms 302 
2017-09-01 14:23:18.136  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 14:23:18.140  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.143  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.152  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 14:23:18.159  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.162  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:18.165  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:18.170  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.174  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.177  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:18.179  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.182  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:18.185  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:18.189  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:18.192  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:18.195  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:18.198  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:18.201  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:18.206  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:18.209  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:18.212  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:18.640  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 14:23:18.959  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 808.5716ms
2017-09-01 14:23:18.963  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 826.6061ms 200 text/html; charset=utf-8
2017-09-01 14:23:21.856  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1021
2017-09-01 14:23:21.864  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:21.869  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:21.880  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 14:23:21.889  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:21.892  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:21.900  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (4ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:21.903  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:21.906  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:21.908  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:21.911  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:21.913  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:21.922  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:21.925  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:21.929  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:21.932  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:21.937  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:21.941  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:21.949  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (4ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:21.956  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:21.959  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:21.963  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Consent/Index.cshtml.
2017-09-01 14:23:21.978  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 100.9277ms
2017-09-01 14:23:21.984  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 127.9868ms 200 text/html; charset=utf-8
2017-09-01 14:23:27.422  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/Consent application/x-www-form-urlencoded 1044
2017-09-01 14:23:27.427  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.432  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.438  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) with arguments (ViewModels.IdentitySite.Consent.ConsentInputModel) - ModelState is Valid
2017-09-01 14:23:27.443  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.447  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:27.452  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:27.455  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.458  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.462  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:27.465  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.469  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.472  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:27.476  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:27.480  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:27.485  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:27.488  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.490  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:27.497  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.513  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 14:23:27.516  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action XL.Identity.WebSite.Controllers.ConsentController.Index (IdentitySite) in 80.8941ms
2017-09-01 14:23:27.519  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 96.7784ms 302 
2017-09-01 14:23:27.524  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5&state=CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 14:23:27.530  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.535  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.538  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 14:23:27.542  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 14:23:27.547  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 14:23:27.550  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 14:23:27.553  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.559  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 14:23:27.563  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 14:23:27.568  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 14:23:27.572  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.577  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.580  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 14:23:27.582  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.585  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 14:23:27.588  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:27.592  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:27.595  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 14:23:27.599  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 14:23:27.602  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.604  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 14:23:27.607  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
  "Nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
  "SessionId": "6bd2b2de804b5afa3f9ae6a1dda2e9c9",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 14:23:27.612  IdentityServer4.Stores.DefaultUserConsentStore   Debug: user_consent grant with value: admin|00000000-0000-0000-0000-000000000001 not found in store.
2017-09-01 14:23:27.619  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: User consented to scopes: openid
2017-09-01 14:23:27.627  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Debug: User indicated to remember consent for scopes: openid
2017-09-01 14:23:27.652  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 14:23:27.666  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 14:23:27.675  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 14:23:27.679  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 14:23:27.721  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4aC4iNMTQ6iI5ixjD3Dbt6NoHEdEaWG5j9cl33u2WveSsvDg6Ln3iNCqiUxG_Ihp0dJrDnsJZC5-cg8POgaV8VzNwccvw5r8PqAh7qwsgcJWzMD9HYb_mRJcsWjqEhJHMRmMberz-jibY1uWpSQ26Wupalcjq0LRSREpCIEUq_-A8GT4BIcX7aUH0weMlTCXZt-C1Ybosf7MCQ8yLZk63lO7D5AVWdKWgJDJNMj7PgzalQ7FD0Hu1yLE8naoEixKKCaYvdlz7E6_7YdFqBV2XWNXYQl-5BvP1Uwb16hXFDGeEilvzRkaQ9DPAstmf4EtT8",
  "Scope": "openid"
}
2017-09-01 14:23:27.734  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.749  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 14:23:27.752  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 14:23:27.755  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 14:23:27.765  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 241.201ms 200 text/html; charset=UTF-8
2017-09-01 15:02:07.167  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 15:02:07.173  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 15:02:07.194  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 15:02:07.576  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession?post_logout_redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDcwMDcsImV4cCI6MTUwNDI0NzMwNywiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDM3OTA5NDEwNDk5Lk4yVTRNak5qWXpRdFpUa3pOQzAwT1RJM0xXRmtabVV0TlRSbFpEZ3dPRFl5Tm1RelpHRXpObVkxTWpFdE1EUmxOUzAwWkdGbExXRTVPR1F0TURsbU1tUTRNekE0TW1FNSIsImlhdCI6MTUwNDI0NzAwNywic2lkIjoiNmJkMmIyZGU4MDRiNWFmYTNmOWFlNmExZGRhMmU5YzkiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDY5OTcsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.ZsdfcsNpWYTThDtz_smawyiqmPxr2HFxjBYQpGHQRNB8GorIOpnAzqysYUZ8yFFVOWi6GGHw1djYUOXreKm7c5oHPLV6wSh4EiXxX12_NszKtUrBTjCjd4NayLX7Ih5ncs77dLTdN0PfxL1V-33Oo-T-vGwVE2fybM_QXQKDxjmT-udy2T_qPYRBcANg7MMnOO9dY5dBWVulasGpIyL12pvMsQcGpXReY41BpZUwwvg6ARd2rBZNxs0HBZb2NSAd1M2nWwufynAng30P_lk1tkG4iUNUcG6kNBtjX1ganGYiYFY4-mXrnaJ1bFV-K9b1ZFp3Y4tOF5jHlVZCtvwKDQ&state=CfDJ8ECGCikUVX1HsEI_-gAmK4Z3cGxgD_tUGcxNV6XzlLDN7C78tEeGd4no45sJqZ6tkE4BxL-A3F1VqLgBSBPr3ANOwyZJaPVxaMXw4TKupxIek1AJUuTc58WvECbgXNfyC26NsbC4SmrRksHNmwuNoNaGoWvGL0ZdQSkDl16ooUmJ&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 15:02:07.608  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:07.623  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:07.627  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession matched to endpoint type Endsession
2017-09-01 15:02:07.635  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 15:02:07.638  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-09-01 15:02:07.654  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:07.658  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout request for 00000000-0000-0000-0000-000000000001
2017-09-01 15:02:07.667  IdentityServer4.Validation.EndSessionRequestValidator   Debug: Start end session request validation
2017-09-01 15:02:07.676  IdentityServer4.Validation.TokenValidator   Debug: Start identity token validation
2017-09-01 15:02:07.867  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (36ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:07.908  IdentityServer4.Validation.TokenValidator   Debug: Client found: admin / 权限管理系统
2017-09-01 15:02:07.931  IdentityServer4.Validation.TokenValidator   Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-09-01 15:02:07.945  IdentityServer4.Validation.TokenValidator   Debug: Token validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1504247007,
    "exp": 1504247307,
    "iss": "http://www.sts.com:5000",
    "aud": "admin",
    "nonce": "636398437909410499.N2U4MjNjYzQtZTkzNC00OTI3LWFkZmUtNTRlZDgwODYyNmQzZGEzNmY1MjEtMDRlNS00ZGFlLWE5OGQtMDlmMmQ4MzA4MmE5",
    "iat": 1504247007,
    "sid": "6bd2b2de804b5afa3f9ae6a1dda2e9c9",
    "sub": "00000000-0000-0000-0000-000000000001",
    "auth_time": 1504246997,
    "idp": "local",
    "amr": "pwd"
  }
}
2017-09-01 15:02:07.949  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:07.958  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:07.965  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 15:02:07.969  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 15:02:07.971  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证PostLogoutRedirectUris：http://www.yxl.com:5001/signout-callback-oidc,Client.PostLogoutRedirectUris：http://www.yxl.com/。结果：True
2017-09-01 15:02:07.974  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 15:02:07.976  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signout-callback-oidc
2017-09-01 15:02:07.986  IdentityServer4.Validation.EndSessionRequestValidator   Information: End session request validation success
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "PostLogOutUri": "http://www.yxl.com:5001/signout-callback-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4Z3cGxgD_tUGcxNV6XzlLDN7C78tEeGd4no45sJqZ6tkE4BxL-A3F1VqLgBSBPr3ANOwyZJaPVxaMXw4TKupxIek1AJUuTc58WvECbgXNfyC26NsbC4SmrRksHNmwuNoNaGoWvGL0ZdQSkDl16ooUmJ",
  "Raw": {
    "post_logout_redirect_uri": "http://www.yxl.com:5001/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzZGNmODA0YjNkNDcwYjM1MGYyY2U1N2IyZDc3M2E5IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDQyNDcwMDcsImV4cCI6MTUwNDI0NzMwNywiaXNzIjoiaHR0cDovL3d3dy5zdHMuY29tOjUwMDAiLCJhdWQiOiJhZG1pbiIsIm5vbmNlIjoiNjM2Mzk4NDM3OTA5NDEwNDk5Lk4yVTRNak5qWXpRdFpUa3pOQzAwT1RJM0xXRmtabVV0TlRSbFpEZ3dPRFl5Tm1RelpHRXpObVkxTWpFdE1EUmxOUzAwWkdGbExXRTVPR1F0TURsbU1tUTRNekE0TW1FNSIsImlhdCI6MTUwNDI0NzAwNywic2lkIjoiNmJkMmIyZGU4MDRiNWFmYTNmOWFlNmExZGRhMmU5YzkiLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJhdXRoX3RpbWUiOjE1MDQyNDY5OTcsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.ZsdfcsNpWYTThDtz_smawyiqmPxr2HFxjBYQpGHQRNB8GorIOpnAzqysYUZ8yFFVOWi6GGHw1djYUOXreKm7c5oHPLV6wSh4EiXxX12_NszKtUrBTjCjd4NayLX7Ih5ncs77dLTdN0PfxL1V-33Oo-T-vGwVE2fybM_QXQKDxjmT-udy2T_qPYRBcANg7MMnOO9dY5dBWVulasGpIyL12pvMsQcGpXReY41BpZUwwvg6ARd2rBZNxs0HBZb2NSAd1M2nWwufynAng30P_lk1tkG4iUNUcG6kNBtjX1ganGYiYFY4-mXrnaJ1bFV-K9b1ZFp3Y4tOF5jHlVZCtvwKDQ",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4Z3cGxgD_tUGcxNV6XzlLDN7C78tEeGd4no45sJqZ6tkE4BxL-A3F1VqLgBSBPr3ANOwyZJaPVxaMXw4TKupxIek1AJUuTc58WvECbgXNfyC26NsbC4SmrRksHNmwuNoNaGoWvGL0ZdQSkDl16ooUmJ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 15:02:07.989  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Success validating end session request from admin
2017-09-01 15:02:08.013  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 448.4145ms 302 
2017-09-01 15:02:08.024  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/logout?logoutId=CfDJ8ECGCikUVX1HsEI_-gAmK4brN1UZj3R7DufQuBMwaG70ym0gG9hjy-10HjkfrhjcKS2cjHkvU0V-w8aiaX120L4ITHjnRFR6z7otyU_gRLRoTKXJKBrYReW7hLqcVc1iYKyj-fdnlvV7_dpz_eaP-npUjr2qGrMqn4q-ZoX14h15GmL14Fqay_inDy0UQiHVLHdfcGuxJICZTIt58vYyyPWtFhZdqgR8KrdgV_FZ6N49VRJUZ5mZ4sB7ZP3e8m3g9dZ5Xcntm96xS5KywklpKT-84o9JJxY_dMDxe84J5_zehPC5LXwORqnZMCahfhc9hEbS13Bmu3ODG1nQnGEJv7Unz26ma3I9GZjhcScEIMYUn_fKY92dBo7cqbbCbanRS9M1sdQ60esfsqytMl3dLnkMb_jodJ-WiuCjShYh7yzHzLa-BymAMdDko4kqxTJqfZkbQlKdoyXXIQJzS81dkzMzvPrJ2YUly5Lx8pSfMuJHX9nzmzIcgf9DSOOEtYg3VxchMYjDRSGzcHiLonJ0LPdcchk7dHYC-FRC3KxwknpjThcYWuS6Zsak7i0U8_wYTbS4yZYFrpQhKcekWVqZjMUH8f5C5XfCBMv21r0ZQvKciRwhZfXuSfc29LO2nEngpQp_8-rlHIla3fb6I4Y3aZkwfLpxjIQDWDjUCfeemxF851ap8gB3dO7wRjeK0hrWJdjW8YmK-jf1v3kAd5qyNB4_hLecqerMO9pal3ZotQ55lkPBv3558pA-vugb-BhQhR9KnCLdqWJw4H-ymwMMR37x6DarhkC9aGfOpKoKkBRmXX1QS0okyTglM687QCukYA  
2017-09-01 15:02:08.029  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.033  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.177  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Logout (IdentitySite) with arguments (CfDJ8ECGCikUVX1HsEI_-gAmK4brN1UZj3R7DufQuBMwaG70ym0gG9hjy-10HjkfrhjcKS2cjHkvU0V-w8aiaX120L4ITHjnRFR6z7otyU_gRLRoTKXJKBrYReW7hLqcVc1iYKyj-fdnlvV7_dpz_eaP-npUjr2qGrMqn4q-ZoX14h15GmL14Fqay_inDy0UQiHVLHdfcGuxJICZTIt58vYyyPWtFhZdqgR8KrdgV_FZ6N49VRJUZ5mZ4sB7ZP3e8m3g9dZ5Xcntm96xS5KywklpKT-84o9JJxY_dMDxe84J5_zehPC5LXwORqnZMCahfhc9hEbS13Bmu3ODG1nQnGEJv7Unz26ma3I9GZjhcScEIMYUn_fKY92dBo7cqbbCbanRS9M1sdQ60esfsqytMl3dLnkMb_jodJ-WiuCjShYh7yzHzLa-BymAMdDko4kqxTJqfZkbQlKdoyXXIQJzS81dkzMzvPrJ2YUly5Lx8pSfMuJHX9nzmzIcgf9DSOOEtYg3VxchMYjDRSGzcHiLonJ0LPdcchk7dHYC-FRC3KxwknpjThcYWuS6Zsak7i0U8_wYTbS4yZYFrpQhKcekWVqZjMUH8f5C5XfCBMv21r0ZQvKciRwhZfXuSfc29LO2nEngpQp_8-rlHIla3fb6I4Y3aZkwfLpxjIQDWDjUCfeemxF851ap8gB3dO7wRjeK0hrWJdjW8YmK-jf1v3kAd5qyNB4_hLecqerMO9pal3ZotQ55lkPBv3558pA-vugb-BhQhR9KnCLdqWJw4H-ymwMMR37x6DarhkC9aGfOpKoKkBRmXX1QS0okyTglM687QCukYA) - ModelState is Valid
2017-09-01 15:02:08.186  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.203  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.206  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.218  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.221  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.230  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (3ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:08.235  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:08.245  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed out.
2017-09-01 15:02:10.429  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml.
2017-09-01 15:02:10.943  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Logout (IdentitySite) in 2804.5045ms
2017-09-01 15:02:10.965  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2940.5227ms 200 text/html; charset=utf-8
2017-09-01 15:02:10.980  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/endsession/callback?endSessionId=CfDJ8ECGCikUVX1HsEI_-gAmK4aR3iCqPG3oHlM0w3teupIp_Wdj2NlrjmWCBsZ015lSeiFV7zTG_N8H6MZuQzD1H9sZ2ymqDJ7rBcGaWugaARW8JEB4F38ELkE-I34vcy5PlP4ZANiENyuC96AXWU7bZA2cvsmiOmfUaIbrdhpFSp8hQw9vY7AxmAMCRCswV3LVaFtYcoI0vQ5sr_AmxmP1bvh2hrVTER1Sq_kwUmsLMceAU9jRCGgeY1sDNQmHFTivUVvqXAs93Z6-xhlH8-zBBBIwlnARWeBwII6T6cF9A5I3miQbLZCfjGxwI17ljciO0w  
2017-09-01 15:02:10.985  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
2017-09-01 15:02:10.988  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-09-01 15:02:10.995  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession/callback
2017-09-01 15:02:11.002  IdentityServer4.Endpoints.EndSessionEndpoint   Debug: Processing signout callback request
2017-09-01 15:02:11.021  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:11.025  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client front-channel logout URLs
2017-09-01 15:02:11.028  IdentityServer4.Validation.EndSessionRequestValidator   Debug: No client back-channel logout URLs
2017-09-01 15:02:11.032  IdentityServer4.Endpoints.EndSessionEndpoint   Information: Successful signout callback. Client logout iframe urls: 
2017-09-01 15:02:11.067  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 87.0383ms 200 text/html; charset=UTF-8
2017-09-01 15:02:13.625  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 15:02:13.628  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize matched to endpoint type Authorize
2017-09-01 15:02:13.633  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 15:02:13.636  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-09-01 15:02:13.647  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize request
2017-09-01 15:02:13.656  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: No user present in authorize request
2017-09-01 15:02:13.663  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 15:02:13.676  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:13.680  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.684  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.686  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 15:02:13.689  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.692  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.732  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:13.751  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:13.776  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:13.779  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:13.790  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 15:02:13.805  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU",
  "Nonce": "636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 15:02:13.817  IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator   Information: Showing login: User is not authenticated
2017-09-01 15:02:13.823  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 198.3592ms 302 
2017-09-01 15:02:13.829  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dadmin%26redirect_uri%3Dhttp%253A%252F%252Fwww.yxl.com%253A5001%252Fsignin-oidc%26response_type%3Did_token%26scope%3Dopenid%26response_mode%3Dform_post%26nonce%3D636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj%26state%3DCfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU%26x-client-SKU%3DID_NET%26x-client-ver%3D2.1.4.0  
2017-09-01 15:02:13.839  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU&x-client-SKU=ID_NET&x-client-ver=2.1.4.0) - ModelState is Valid
2017-09-01 15:02:13.860  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 15:02:13.865  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:13.869  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.873  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.876  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 15:02:13.879  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.881  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:13.885  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:13.888  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:13.892  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:13.896  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:13.899  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 15:02:13.905  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:14.253  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Account/Login.cshtml.
2017-09-01 15:02:14.285  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 447.1027ms
2017-09-01 15:02:14.289  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 460.3661ms 200 text/html; charset=utf-8
2017-09-01 15:02:15.575  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 POST http://www.sts.com:5000/account/Login application/x-www-form-urlencoded 956
2017-09-01 15:02:15.611  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.AccountController.Login (IdentitySite) with arguments (ViewModels.IdentitySite.Account.LoginInputModel) - ModelState is Valid
2017-09-01 15:02:15.629  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[@__model_LoginName_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AccessFailedCount], [a].[CreateDate], [a].[Email], [a].[EmailConfirmed], [a].[ImgUrl], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[LoginName], [a].[MobilePhone], [a].[MobilePhoneConfirmed], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedLoginName], [a].[OrganizationID], [a].[Password], [a].[PyCode], [a].[UpdateDate]
FROM [User] AS [a]
WHERE [a].[LoginName] = @__model_LoginName_0
2017-09-01 15:02:15.656  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 15:02:15.663  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 15:02:15.667  Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor   Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU&x-client-SKU=ID_NET&x-client-ver=2.1.4.0.
2017-09-01 15:02:15.674  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.AccountController.Login (IdentitySite) in 82.6799ms
2017-09-01 15:02:15.678  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 102.2741ms 302 
2017-09-01 15:02:15.683  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/connect/authorize/callback?client_id=admin&redirect_uri=http%3A%2F%2Fwww.yxl.com%3A5001%2Fsignin-oidc&response_type=id_token&scope=openid&response_mode=form_post&nonce=636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj&state=CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU&x-client-SKU=ID_NET&x-client-ver=2.1.4.0  
2017-09-01 15:02:15.687  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.692  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.696  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
2017-09-01 15:02:15.699  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-09-01 15:02:15.703  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize/callback
2017-09-01 15:02:15.718  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: Start authorize callback request
2017-09-01 15:02:15.724  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.731  IdentityServer4.Endpoints.AuthorizeEndpoint   Debug: User in authorize request: 00000000-0000-0000-0000-000000000001
2017-09-01 15:02:15.735  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Start authorize request protocol validation
2017-09-01 15:02:15.741  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[@__clientId_0='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[ID], [a].[AppKey], [a].[AppSecrets], [a].[ClientUri], [a].[CreateDate], [a].[LogOutUri], [a].[Name], [a].[UpdateDate]
FROM [Client] AS [a]
WHERE [a].[AppKey] = @__clientId_0
2017-09-01 15:02:15.746  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:15.751  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:15.756  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 验证RedirectUri：http://www.yxl.com:5001/signin-oidc,Client.RedirectUris：http://www.yxl.com/。结果：True
2017-09-01 15:02:15.760  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUrL for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:15.763  IdentitySite.Services.IdentityService.Validation.HostRedirectUriValidator   Debug: 正在验证 requestedUri for http://www.yxl.com:5001/signin-oidc
2017-09-01 15:02:15.768  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:15.774  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:15.779  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 1
2017-09-01 15:02:15.783  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
WHERE [a].[ApiType] = 0
2017-09-01 15:02:15.786  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.791  IdentityServer4.Validation.AuthorizeRequestValidator   Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-09-01 15:02:15.793  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: ValidatedAuthorizeRequest
{
  "ClientId": "admin",
  "ClientName": "权限管理系统",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://www.yxl.com/"
  ],
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ResponseType": "id_token",
  "ResponseMode": "form_post",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU",
  "Nonce": "636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj",
  "SessionId": "5a1c28807175a9463778fd79b1fe2a28",
  "Raw": {
    "client_id": "admin",
    "redirect_uri": "http://www.yxl.com:5001/signin-oidc",
    "response_type": "id_token",
    "scope": "openid",
    "response_mode": "form_post",
    "nonce": "636398461336138219.M2NiOTg4MDEtYjZiYS00ZGMzLWFiNGYtYTA5OTQwZTlmMzZjZmQ3Yzg5ZDItZTE4OC00NzMyLThhN2MtZGNkODkyNzc1Yzhj",
    "state": "CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-09-01 15:02:15.814  IdentityServer4.ResponseHandling.AuthorizeResponseGenerator   Debug: Creating Implicit Flow response.
2017-09-01 15:02:15.826  IdentityServer4.Services.DefaultClaimsService   Debug: Getting claims for identity token for subject: 00000000-0000-0000-0000-000000000001 and client: admin
2017-09-01 15:02:15.833  IdentityServer4.Services.DefaultProfileService   Debug: Get profile called for subject 00000000-0000-0000-0000-000000000001 from client 权限管理系统 with claim types  via ClaimsProviderIdentityToken
2017-09-01 15:02:15.837  IdentityServer4.Services.DefaultProfileService   Debug: Issued claims: 
2017-09-01 15:02:15.879  IdentityServer4.Endpoints.AuthorizeEndpoint   Information: Authorize endpoint response
{
  "SubjectId": "00000000-0000-0000-0000-000000000001",
  "ClientId": "admin",
  "RedirectUri": "http://www.yxl.com:5001/signin-oidc",
  "State": "CfDJ8ECGCikUVX1HsEI_-gAmK4b0Y5MGEbfxskJFZG8gkaQeWXDrW4NIDCorban7BgflTt5rv_D8nXlJz1xwLg1FJWVItQUONNO3dRsje9IP-SjnT28noqTEwC8RD8hDUri4bTg4BSFoNepzoyYO-0XcowWSqDbFw2O7tEJdxHFFKiYR5uNV1nQPvcIwQwVVR-LJmdLr82_nEifEJ37n99jq0Kn4J6fyJiPbZ-zYoFaO5VNuzoDoUARXQJEmWMrRy1rKCUhhr9Dei2NFbUUhrIXbhe5ZRXfxQHdV_cquRJyEx-3DA61Y2OZXtNAxhZatM0O1hd5Kj5fWZbFgfl5Y7pJGsaU",
  "Scope": "openid"
}
2017-09-01 15:02:15.889  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.898  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 15:02:15.900  IdentityServer4.Hosting.IdentityServerAuthenticationService   Debug: Augmenting SignInContext
2017-09-01 15:02:15.905  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv signed in.
2017-09-01 15:02:15.913  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 229.8264ms 200 text/html; charset=UTF-8
2017-09-01 16:15:58.634  Microsoft.EntityFrameworkCore.Infrastructure   Information: Entity Framework Core 2.0.0-rtm-26452 initialized 'PermissionSystemContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2017-09-01 16:15:58.649  IdentityServer4.Startup   Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-09-01 16:15:58.667  IdentityServer4.Hosting.CookieConfiguration   Debug: Using hosting application's CookieAuthentication middleware with scheme: idsrv
2017-09-01 16:15:58.925  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/  
2017-09-01 16:15:58.960  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 16:15:58.974  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 16:15:59.069  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executing action method IdentitySite.Controllers.HomeController.Index (IdentitySite) with arguments ((null)) - ModelState is Valid
2017-09-01 16:16:01.012  Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor   Information: Executing ViewResult, running view at path /Views/Home/Index.cshtml.
2017-09-01 16:16:01.677  Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker   Information: Executed action IdentitySite.Controllers.HomeController.Index (IdentitySite) in 2613.954ms
2017-09-01 16:16:01.692  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 2779.168ms 200 text/html; charset=utf-8
2017-09-01 16:16:09.496  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request starting HTTP/1.1 GET http://www.sts.com:5000/.well-known/openid-configuration  
2017-09-01 16:16:09.508  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 16:16:09.513  Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler   Information: AuthenticationScheme: idsrv was successfully authenticated.
2017-09-01 16:16:09.517  IdentityServer4.Hosting.EndpointRouter   Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-09-01 16:16:09.528  IdentityServer4.Hosting.EndpointRouter   Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-09-01 16:16:09.532  IdentityServer4.Hosting.IdentityServerMiddleware   Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-09-01 16:16:09.539  IdentityServer4.Endpoints.DiscoveryEndpoint   Debug: Start discovery request
2017-09-01 16:16:09.731  Microsoft.EntityFrameworkCore.Database.Command   Information: Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[Action], [a].[ApiType], [a].[ApplicationID], [a].[Area], [a].[Assembly], [a].[Controller], [a].[CreateDate], [a].[DisplayName], [a].[MethodName], [a].[UpdateDate]
FROM [Api] AS [a]
2017-09-01 16:16:09.813  Microsoft.AspNetCore.Hosting.Internal.WebHost   Information: Request finished in 317.0796ms 200 application/json
